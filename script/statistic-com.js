//dt
sr.DatePickerCalendar=function(e,t,a){this.type=e,this.Parent=t,this.DateVal=a||new Date,this.DateValNew=a||new Date,this.DotList=[];var s=document.createElement("div");sr.StyleUtil.set(s,"display","none"),"month"==this.type||"year"==this.type?s.className="date-calendar date-calendar4x3":"day"!=this.type&&"week"!=this.type||(s.className="date-calendar date-calendar7x6"),this.html=s,sr.DatePickerCalendar.prototype.setPosition=function(){sr.StyleUtil.set(this.html,"display","none"),sr.StyleUtil.set(this.html,"top",this.Parent.html.offsetTop+42+"px");var e=document.body.offsetWidth,t=this.Parent.html.offsetLeft;0<t+305-e?sr.StyleUtil.set(this.html,"left",e-305+"px"):sr.StyleUtil.set(this.html,"left",t+"px")},this.Parent.html.appendChild(this.html);var i=this;if(sr.DatePickerCalendar.prototype.setDate=function(e){this.DateVal=e,this.DateValNew=e},sr.DatePickerCalendar.prototype.preCheckDay=function(e,t,a){var s=sr.DateUtil.getMonthEndDay(new Date(e,t,1));return s.getDate()<a?s.getDate():a},sr.DatePickerCalendar.prototype.refresh=function(e){if(e=e||this.DateVal,sr.StyleUtil.set(this.html,"display","none"),"month"==this.type){this.ToggleBar.innerHTML=sr.DateUtil.format(e,"yyyy");for(var t=0;t<this.DotList.length;t++){var a=this.DotList[t],s=sr.DateUtil.getDate(a.getAttribute("value")),r=this.preCheckDay(e.getFullYear(),t,e.getDate());s.setDate(r),s.setYear(e.getFullYear()),s.setMonth(t),a.setAttribute("value",sr.DateUtil.format(s,"yyyy-mm-dd")),sr.DateUtil.format(s,"yyyymm")==sr.DateUtil.format(this.DateVal,"yyyymm")?sr.ClassUtil.add(a,"date-calendar-choosed"):sr.ClassUtil.del(a,"date-calendar-choosed"),sr.DateUtil.format(s,"yyyymm")==sr.DateUtil.format(new Date,"yyyymm")?sr.ClassUtil.add(a,"date-calendar-today"):sr.ClassUtil.del(a,"date-calendar-today")}}else if("day"==this.type||"week"==this.type){this.ToggleBar.innerHTML=sr.DateUtil.format(e,"yyyy mmm");var i=[],l=sr.DateUtil.getWeekStartDay(sr.DateUtil.getMonthStartDay(e));for(t=0;t<42;t++){var d=new Date(l);d.setDate(d.getDate()+t),i.push(d)}for(t=0;t<this.DotList.length;t++){if((a=this.DotList[t]).setAttribute("value",sr.DateUtil.format(i[t],"yyyy-mm-dd")),a.innerHTML=sr.DateUtil.format(i[t],"dd"),i[t]-this.DateVal==0?sr.ClassUtil.add(a,"date-calendar-choosed"):sr.ClassUtil.del(a,"date-calendar-choosed"),sr.DateUtil.format(i[t],"yyyymmdd")==sr.DateUtil.format(new Date,"yyyymmdd")?sr.ClassUtil.add(a,"date-calendar-today"):sr.ClassUtil.del(a,"date-calendar-today"),i[t].getMonth()!=this.DateValNew.getMonth()?sr.ClassUtil.add(a,"date-calendar-other"):sr.ClassUtil.del(a,"date-calendar-other"),"week"==this.type){var n=sr.DateUtil.getWeekStartDay(this.DateValNew),o=sr.DateUtil.getWeekEndDay(this.DateValNew);0<=i[t]-n&&0<=o-i[t]?sr.ClassUtil.add(a,"date-calendar-thisWk"):sr.ClassUtil.del(a,"date-calendar-thisWk")}}}else if("year"==this.type){var h=sr.DateUtil.get10YearsStart(e);this.ToggleBar.innerHTML=h+" - "+(h+10);for(t=0;t<this.DotList.length;t++){a=this.DotList[t],s=sr.DateUtil.getDate(a.getAttribute("value")),r=this.preCheckDay(h+t,e.getMonth(),e.getDate());s.setDate(r),s.setYear(h+t),s.setMonth(e.getMonth()),a.setAttribute("value",sr.DateUtil.format(s,"yyyy-mm-dd")),a.innerHTML=s.getFullYear(),s.getFullYear()==this.DateVal.getFullYear()?sr.ClassUtil.add(a,"date-calendar-choosed"):sr.ClassUtil.del(a,"date-calendar-choosed"),s.getFullYear()==(new Date).getFullYear()?sr.ClassUtil.add(a,"date-calendar-today"):sr.ClassUtil.del(a,"date-calendar-today"),s.getFullYear()<=h||s.getFullYear()>h+10?sr.ClassUtil.add(a,"date-calendar-other"):sr.ClassUtil.del(a,"date-calendar-other")}}this.setPosition(),sr.StyleUtil.set(this.html,"display","block")},sr.DatePickerCalendar.prototype.show=function(e){e?this.refresh():sr.StyleUtil.set(this.html,"display","none")},sr.DatePickerCalendar.prototype.addTitle=function(e,t){t.className="date-calendar-label";var a=document.createElement("li");a.innerHTML=e,a.className="date-calendar-item",t.appendChild(a)},sr.DatePickerCalendar.prototype.addItem=function(e,t){var a=document.createElement("li");a.className="date-calendar-item",t.appendChild(a);var s=document.createElement("a");s.className="date-calendar-item-a",s.setAttribute("value",sr.DateUtil.format(e,"yyyy-mm-dd")),a.appendChild(s),"month"==this.type?(s.innerHTML=sr.DateUtil.format(e,"mmm"),sr.DateUtil.format(e,"yyyymmm")==sr.DateUtil.format(this.DateVal,"yyyymmm")&&sr.ClassUtil.add(s,"date-calendar-choosed")):"day"==this.type||"week"==this.type?(s.innerHTML=sr.DateUtil.format(e,"dd"),sr.DateUtil.format(e,"yyyymmdd")==sr.DateUtil.format(this.DateVal,"yyyymmdd")&&sr.ClassUtil.add(s,"date-calendar-choosed")):"year"==this.type&&(s.innerHTML=e.getFullYear(),e.getFullYear()==this.DateVal.getFullYear()&&sr.ClassUtil.add(s,"date-calendar-choosed")),this.DotList.push(s)},sr.DatePickerCalendar.prototype.addLine=function(e,t){var a=document.createElement("ul");a.className="date-calendar-row",t.appendChild(a);for(var s=0;s<e.length;s++)this.addItem(sr.DateUtil.getDate(e[s]),a)},"year"==this.type||"month"==this.type||"day"==this.type||"week"==this.type){var r=document.createElement("h3");sr.ClassUtil.add(r,"date-calendar-header"),this.html.appendChild(r);var l=document.createElement("span");l.className="date-picker-button",r.appendChild(l);var d=document.createElement("a");l.appendChild(d),(p=document.createElement("i")).className="date-picker-button-prev",d.appendChild(p),(l=document.createElement("span")).className="date-calendar-header-box",r.appendChild(l);var n=document.createElement("a");if(l.appendChild(n),this.ToggleBar=n,"month"==this.type)n.innerHTML=sr.DateUtil.format(this.DateVal,"yyyy");else if("day"==this.type||"week"==this.type)n.innerHTML=sr.DateUtil.format(this.DateVal,"yyyy mmm");else if("year"==this.type){var o=sr.DateUtil.get10YearsStart(new Date);n.innerHTML=o+" - "+(o+10)}(l=document.createElement("span")).className="date-picker-button",r.appendChild(l),d=document.createElement("a"),(p=document.createElement("i")).className="date-picker-button-next",d.appendChild(p),l.appendChild(d);var h=function(e,t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;var a=i.DateValNew.getFullYear(),s=i.DateValNew.getMonth(),r=i.DateValNew.getDate();"month"==i.type?e?a++:a--:"day"==i.type||"week"==i.type?e?s++:0==s?(a--,s=11):s--:"year"==i.type&&(e?a+=10:a-=10),r=i.preCheckDay(a,s,r),i.DateValNew=new Date(a,s,r),i.refresh(i.DateValNew)};sr.EventUtil.add(r,"click",function(e){var t=e||window.event,a=t.srcElement||t.target;"I"==a.nodeName?"date-picker-button-prev"==a.className?h(!1,e):"date-picker-button-next"==a.className&&h(!0,e):"A"==a.nodeName&&("date-picker-button-prev"==a.firstChild.className?h(!1,e):"date-picker-button-next"==a.firstChild.className?h(!0,e):"date-calendar-header-box"==a.parentNode.className&&i.Parent.showUpperCalendar(i.type,i.DateVal,e))});var c=document.createElement("div");sr.ClassUtil.add(c,"date-calendar-body"),this.html.appendChild(c),this.body=c;var y=[];if("month"==this.type){for(var D,p=0;p<12;p++)m=new Date,(D=sr.DateUtil.getMonthEndDay(new Date(m.getFullYear(),p,1))).getDate()<m.getDate()&&m.setDate(D.getDate()),m.setMonth(p),y.push(m);this.addLine(y.slice(0,4),c),this.addLine(y.slice(4,8),c),this.addLine(y.slice(8,12),c)}else if("year"==this.type){for(o=sr.DateUtil.get10YearsStart(new Date),p=0;p<12;p++){var m=new Date,u=i.preCheckDay(o+p,m.getMonth(),m.getDate());m.setDate(u),m.setYear(o+p),y.push(m)}this.addLine(y.slice(0,4),c),this.addLine(y.slice(4,8),c),this.addLine(y.slice(8,12),c)}else if("day"==this.type||"week"==this.type){var C=document.createElement("ul");C.className="date-calendar-row",this.addTitle("Mon",C),this.addTitle("Tue",C),this.addTitle("Wed",C),this.addTitle("Thu",C),this.addTitle("Fri",C),this.addTitle("Sat",C),this.addTitle("Sun",C),this.body.appendChild(C);var g=sr.DateUtil.getWeekStartDay(sr.DateUtil.getMonthStartDay(i.DateVal));for(p=0;p<42;p++){(m=new Date(g)).setDate(m.getDate()+p),y.push(m)}this.addLine(y.slice(0,7),c),this.addLine(y.slice(7,14),c),this.addLine(y.slice(14,21),c),this.addLine(y.slice(21,28),c),this.addLine(y.slice(28,35),c),this.addLine(y.slice(35,42),c)}sr.EventUtil.add(c,"click",function(e){var t=e||window.event,a=t.srcElement||t.target;"A"==a.nodeName&&(i.Parent.closeCalendar(i.type,a.getAttribute("value")),i.show(!1),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)})}sr.EventUtil.add(document,"click",function(e){i.show(!1)},!1),sr.EventUtil.add(window,"resize",function(e){i.setPosition()}),sr.StyleUtil.del(s,"display"),this.show(!1)},sr.DatePeriodPicker=function(e,t,a,s,i){var r=document.createElement("div");sr.StyleUtil.set(r,"display","none"),sr.ClassUtil.add(r,"date-picker"),e.appendChild(r),this.html=e,this.style=a||1,this.PeriodType=t.toLowerCase()||"month",this.BaseDate=s||new Date,this.CalendarDay=new sr.DatePickerCalendar("day",this),this.CalendarWk=new sr.DatePickerCalendar("week",this),this.CalendarMth=new sr.DatePickerCalendar("month",this),this.CalendarYr=new sr.DatePickerCalendar("year",this);var l=this;sr.DatePeriodPicker.prototype.setPeriodType=function(e){this.PeriodType=e,this.fillDate(),null!=i&&i(this)},sr.DatePeriodPicker.prototype.changeDate=function(e){this.BaseDate=e,this.fillDate(),null!=i&&i(this)},sr.DatePeriodPicker.prototype.fillDate=function(){if(1==a){var e="";switch(this.PeriodType){case"day":case"week":e=sr.DateUtil.format(this.BaseDate,"yyyy-mm-dd");break;case"month":e=sr.DateUtil.format(this.BaseDate,"yyyy mmm");break;case"year":e=this.BaseDate.getFullYear()}this.StartDayBox.innerHTML=e}else 2==a&&(this.StartDayBox.innerHTML=this.getStartDay(),this.EndDayBox.innerHTML=this.getEndDay())},sr.DatePeriodPicker.prototype.showCalendar=function(e){var t=null;switch(this.PeriodType){case"day":t=this.CalendarDay;break;case"week":t=this.CalendarWk;break;case"month":t=this.CalendarMth;break;case"year":t=this.CalendarYr}t.setDate(this.BaseDate),t.show(e)},sr.DatePeriodPicker.prototype.getStartDay=function(){var e=null;switch(this.PeriodType){case"day":e=this.BaseDate;break;case"week":e=sr.DateUtil.getWeekStartDay(this.BaseDate);break;case"month":e=sr.DateUtil.getMonthStartDay(this.BaseDate);break;case"year":e=this.BaseDate.getFullYear()+"-01-01"}return sr.DateUtil.format(e,"yyyy-mm-dd")},sr.DatePeriodPicker.prototype.getEndDay=function(){var e=null;switch(this.PeriodType){case"day":e=this.BaseDate;break;case"week":e=sr.DateUtil.getWeekEndDay(this.BaseDate);break;case"month":e=sr.DateUtil.getMonthEndDay(this.BaseDate);break;case"year":e=this.BaseDate.getFullYear()+"-12-31"}return sr.DateUtil.format(e,"yyyy-mm-dd")},sr.DatePeriodPicker.prototype.showUpperCalendar=function(e,t,a){"day"==e||"week"==e?(this.CalendarMth.setDate(t),this.CalendarMth.show(!0),"day"==e?this.CalendarDay.show(!1):"week"==e&&this.CalendarWk.show(!1)):"month"==e&&(this.CalendarYr.setDate(t),this.CalendarYr.show(!0),this.CalendarMth.show(!1)),a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},sr.DatePeriodPicker.prototype.closeCalendar=function(e,t){if(t=sr.DateUtil.getDate(t),this.PeriodType!=e){var a=null;"month"==e?"day"==this.PeriodType?a=this.CalendarDay:"week"==this.PeriodType&&(a=this.CalendarWk):"year"==e&&(a=this.CalendarMth),a.setDate(t),a.show(!0)}else this.changeDate(t)},sr.DatePeriodPicker.prototype.preCheckDay=function(e,t,a){var s=sr.DateUtil.getMonthEndDay(new Date(e,t,1));return s.getDate()<a?s.getDate():a},(h=document.createElement("span")).className="date-picker-button";var d=document.createElement("a");h.appendChild(d);var n=document.createElement("i");d.appendChild(n),n.className="date-picker-button-prev",r.appendChild(h),sr.EventUtil.add(d,"click",function(){var e=l.BaseDate.getFullYear(),t=l.BaseDate.getMonth(),a=l.BaseDate.getDate(),s=l.PeriodType;if("day"==s)a--;else if("week"==s){if((a-=7)<0)a=sr.DateUtil.getMonthEndDay(new Date(e,t-1,1)).getDate()+a,t--}else"month"==s?0==t?(t=11,e--):t--:"year"==s&&e--;a=l.preCheckDay(e,t,a),l.BaseDate=new Date(e,t,a),l.fillDate(),null!=i&&i(l)});var o=document.createElement("span");sr.ClassUtil.add(o,"date-picker-box"),r.appendChild(o),this.MainBox=o;var h,c=document.createElement("span");sr.ClassUtil.add(c,"date-picker-box-input"),o.appendChild(c),this.StartDayBox=c,2==a&&((c=document.createElement("span")).innerHTML="-",o.appendChild(c),c=document.createElement("span"),sr.ClassUtil.add(c,"date-picker-box-input"),o.appendChild(c),this.EndDayBox=c),sr.EventUtil.add(this.MainBox,"click",function(e){l.showCalendar(!0),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}),this.fillDate(),(h=document.createElement("span")).className="date-picker-button";d=document.createElement("a");h.appendChild(d),r.appendChild(h),n=document.createElement("i"),d.appendChild(n),n.className="date-picker-button-next",sr.EventUtil.add(d,"click",function(){var e=l.BaseDate.getFullYear(),t=l.BaseDate.getMonth(),a=l.BaseDate.getDate(),s=l.PeriodType;if("day"==s)++a>sr.DateUtil.getMonthEndDay(new Date(e,t,1)).getDate()&&(a=1,t++);else if("week"==s){a+=7;var r=sr.DateUtil.getMonthEndDay(new Date(e,t,1)).getDate();r<a&&(a-=r,t++)}else"month"==s?t++:"year"==s&&e++;a=l.preCheckDay(e,t,a),l.BaseDate=new Date(e,t,a),l.fillDate(),null!=i&&i(l)}),sr.StyleUtil.del(r,"display")};


//tb
sr.TabButton=function(t,e){this.Id=t.id||"",this.Name=t.name||"",this.Event=t.event||null,this.Parent=e;var n=document.createElement("li");n.className="tab-bar-li",n.setAttribute("name",this.Name),e.Wrapper.appendChild(n);var a=document.createElement("a");a.className="tab-bar-a",n.appendChild(a),a.innerHTML=this.Name,this.Html=a,sr.TabButton.prototype.choosed=function(t){t?(sr.ClassUtil.add(this.Html,"tab-bar-choosed"),this.Parent.CurrentVal=this.Name,this.Event&&this.Event(this)):sr.ClassUtil.del(this.Html,"tab-bar-choosed")}},sr.TabMenu=function(t,e){var n=document.getElementById(t),a=document.createElement("ul");n.appendChild(a),sr.ClassUtil.add(a,"tab-bar"),this.Wrapper=a,this.BtnList=[],sr.TabMenu.prototype.size=function(){return this.BtnList.length},sr.TabMenu.prototype.item=function(t){return this.BtnList[t]};for(var s=0;s<e.length;s++){var i=new sr.TabButton(e[s],this);this.BtnList.push(i)}this.BtnList[0].choosed(!0);var r=this;sr.EventUtil.add(a,"click",function(t){var e=t||window.event,n=e.srcElement||e.target,a="";if("LI"==n.nodeName)a=n.getAttribute("name");else if("A"==n.nodeName)a=n.parentNode.getAttribute("name");if(0<a.length)for(var s=0;s<r.BtnList.length;s++){var i=r.BtnList[s];i.choosed(a==i.Name)}})};


//ba
sr.Chart.BarFactory={getPixelRatio:function(t){var i=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/i},create:function(t,i,e){if(t.isInit=!1,t.CanvasBack=null,t.CanvasMain=null,t.CtxBack=null,t.CtxMain=null,t.Label=null,t.ChildList=[],t.ActiveBar=null,t.SelectBar=null,t.HTML=i,!t.isInit){i.offsetHeight<240&&i.style.setProperty("height","240px"),i.offsetWidth<240&&i.style.setProperty("width","240px");var a=document.createElement("canvas");if(!a.getContext)return!(i.innerHTML='<div style="text-align:center;margin:20px auto;line-height:25px;font-size:12px;">Sorry T T. <br />Your browser not support HTML5</div>');i.appendChild(a),t.CanvasBack=a,t.CtxBack=a.getContext("2d"),t.Width=i.offsetWidth,t.Height=i.offsetHeight;var s=sr.Chart.BarFactory.getPixelRatio(t.CtxBack)||1;a.height=t.Height*s,a.width=t.Width*s,a.style.cssText="height:"+t.Height+"px;width:"+t.Width+"px;position:absolute;",t.CtxBack.scale(s,s),(a=document.createElement("canvas")).height=t.Height*s,a.width=t.Width*s,a.style.cssText="width:"+t.Width+"px;height:"+t.Height+"px;position:absolute;",i.appendChild(a),t.CanvasMain=a,t.CtxMain=a.getContext("2d"),t.CtxMain.scale(s,s),t.Label="h"==e?new sr.Chart.BarLabel(t,"r"):new sr.Chart.BarLabel(t),t.isInit=!0}},setSpecialBar:function(t,i,e){var a=null;if("hover"==e)a=t.ActiveBar;else if("click"==e)a=t.SelectBar;i!=a&&("click"==e?(null!=a&&a.reDraw(!1),(t.SelectBar=i)?(i.reDraw(!0),t.Label.move(i)):t.Label.show(!1),t.BarEvent&&t.BarEvent(i)):"hover"==e&&(t.ActiveBar=i,null!=a&&t.SelectBar!=a&&a.reDraw(!1),i?(i.reDraw(!0),t.SelectBar||t.Label.move(i)):t.SelectBar||t.Label.show(!1)))},set:function(t,i){t.Width,t.Height;t.clear(),t.ActiveBar=null,t.SelectBar=null,t.Title=i.title||"",t.Borders=i.borders||!1,t.LabelSize=i.labelsize||"L",t.Alpha=i.alpha||1,t.BarEvent=i.event||null,t.TopH=60,t.BottomH=30,t.digit=0,t.Label.show(!1);var e=t.CtxBack;if(e.font="20px calibri",e.fillStyle=sr.Chart.ThemeColor.Title(),e.textAlign="left",e.textBaseline="middle",e.fillText(t.Title,20,t.TopH/2),t.isNoData=!1,i.data){if(0==i.data.length)t.isNoData=!0;else for(var a=0;a<i.data.length;a++)if(!i.data[a].list){t.isNoData=!0;break}}else t.isNoData=!0;t.isNoData&&(e.font="20px calibri",e.textAlign="center",e.textBaseline="middle",e.fillStyle=sr.Chart.ThemeColor.FontLight(),e.fillText("No data",t.Width/2,(t.Height-t.BottomH)/2))},getMaxMin:function(t,i,e){for(var a=i.data[0].list[0]||0,s=i.data[0].list[0]||0,o=0;o<i.data.length;o++){var r=i.data[o];if(r.list)for(var h=0;h<r.list.length;h++)r.list[h]>a&&(a=r.list[h]),r.list[h]<s&&(s=r.list[h]),-1<r.list[h].toString().indexOf(".")&&t.digit<r.list[h].toString().split(".")[1].length&&(t.digit=r.list[h].toString().split(".")[1].length)}0==a&&(a=5);var l=0;a-s<.05?l=3:a-s<.5?l=2:a-s<5&&(l=1),l>t.digit&&(t.digit=l),e.max=a,e.min=s},drawLegend:function(t,i){var e=t.CtxMain,a=0,s=0,o=t.Width;e.font="12px arial",e.textAlign="left",e.textBaseline="middle";for(var r=i.data.length-1;0<=r;r--){var h=i.data[r];e.fillStyle=sr.Chart.ThemeColor.Font(),s=e.measureText(h.category||"category"+(r+1)).width,e.fillText(h.category||"category"+(r+1),o-a-(s+30),t.TopH/2);var l=new sr.Chart.ColorSet(h.color);e.fillStyle=l.getFillColor(1),e.strokeStyle=l.getLineColor(1),e.lineWidth=.5,e.beginPath(),e.rect(o-a-(s+45),t.TopH/2-3,6,6),e.fill(),e.stroke(),e.closePath(),a+=s+50}},addEvent:function(l){sr.EventUtil.add(l.Label.Canvas,"mousemove",sr.EventUtil.throttle(function(t){for(var i=sr.MouseUtil.getEventPosition(t,l.CanvasMain),e=!1,a=null,s=l.YList||l.XList,o=0;o<l.ChildList.length;o++){var r=l.ChildList[o];if(r.BarList){for(var h=0;h<s.length;h++)if(r.BarList[h]&&(e=r.BarList[h].isMouseIn(i.x,i.y))){a=r.BarList[h];break}if(e)break}}(0<i.x||0<i.y)&&l.setSpecialBar(a,"hover")},120,120),!1),sr.EventUtil.add(l.Label.Canvas,"click",function(t){for(var i=sr.MouseUtil.getEventPosition(t,l.CanvasMain),e=!1,a=null,s=l.YList||l.XList,o=0;o<l.ChildList.length;o++){var r=l.ChildList[o];if(r.BarList){for(var h=0;h<s.length;h++)if(e=r.BarList[h].isMouseIn(i.x,i.y)){a=r.BarList[h];break}if(e)break}}l.setSpecialBar(a,"click")},!1),sr.EventUtil.add(l.Label.Canvas,"mouseleave",function(t){l.SelectBar||l.Label.show(!1,!0)},!1)},clear:function(t){var i=t.Width,e=t.Height,a=t.CtxBack;a.beginPath(),a.clearRect(0,0,i,e),a.closePath(),(a=t.CtxMain).beginPath(),a.clearRect(0,0,i,e),a.closePath(),t.Label.show(!1);for(var s=0;s<t.ChildList.length;s++){for(var o=t.ChildList[s],r=0;r<o.BarList.length;r++)o.BarList[r].clear();o.BarList.length=0}t.ChildList.length=0}},sr.Chart.BarItem=function(t,i,e,a,s){this.Category=t,this.XName=i,this.YVal=e,this.Left=0,this.Top=0,this.Width=0,this.Height=0,this.Color=new sr.Chart.ColorSet,this.GradientColor=null,this.Parent=a,this.Context=a.CtxMain,this.isHorizontal=s||!1,sr.Chart.BarItem.prototype.setColor=function(t){this.Color=new sr.Chart.ColorSet(t)},sr.Chart.BarItem.prototype.getFillColor=function(t){return this.Color.getFillColor(t)},sr.Chart.BarItem.prototype.getLineColor=function(t){return this.Color.getLineColor(t)},sr.Chart.BarItem.prototype.setGradientColor=function(t){this.GradientColor=t},sr.Chart.BarItem.prototype.isMouseIn=function(t,i){var e=this.Left,a=this.Top;return this.Parent.XList?t<=e+this.Width&&e<=t&&a-10<=i&&i<=a+this.Height+10:t<=e+this.Width+10&&e-10<=t&&a<=i&&i<=a+this.Height},sr.Chart.BarItem.prototype.render=function(t,i,e,a,s){var o=this.Context;o.beginPath(),o.clearRect(t,i,e,a),o.closePath();var r=this.Parent.Alpha,h=null;if(h=this.isHorizontal?o.createLinearGradient(t+e,0,t,0):o.createLinearGradient(0,i,0,i+a),this.GradientColor){for(var l=this.GradientColor,n=0;n<l.length;n++){var f=new sr.Chart.ColorSet(l[n].color),d=l[n].pos;r=l[n].alpha||r||1;this.YVal<0&&(d=1-d),s?h.addColorStop(d,f.getFillHighColor(r)):h.addColorStop(d,f.getFillColor(r))}o.fillStyle=h}else o.fillStyle=s?this.Color.getFillHighColor(r):this.Color.getFillColor(r);o.beginPath(),o.rect(t,i,e,a),o.fill(),o.closePath(),this.Parent.Borders&&(o.strokeStyle=this.Color.getLineColor(1),o.lineWidth=.5,o.beginPath(),o.moveTo(t+.5,i),o.lineTo(t+e-.5,i),o.moveTo(t+e-.5,i+a),o.lineTo(t+e-.5,i),this.isHorizontal?(o.moveTo(t+.5,i+a),o.lineTo(t+e-.5,i+a)):(o.moveTo(t+.5,i+a),o.lineTo(t+.5,i)),o.strokeStyle=this.Color.getLineColor(1),o.stroke()),o.closePath()},sr.Chart.BarItem.prototype.reDraw=function(t){this.render(this.Left,this.Top,this.Width,this.Height,t)},this.DrawRate=0,sr.Chart.BarItem.prototype.speed=8,this.looped=null,sr.Chart.BarItem.prototype.draw1Frame=function(t){var i=this.Height,e=this.Top,a=this.Left,s=this.Width;this.isHorizontal?(s=this.Width*t,this.YVal<0&&(a=this.Left+this.Width-s)):(i=this.Height*t,0<this.YVal&&(e=this.Top+this.Height-i)),this.render(a,e,s,i,!1)};var o=this;this.loopAnimation=function(){o.looped=requestAnimationFrame(o.loopAnimation);var t=o.DrawRate,i=o.speed;t<100?(t=100<t+i?100:t+i,o.draw1Frame(t/100),o.DrawRate=t):(window.cancelAnimationFrame(o.looped),o.looped=null)},sr.Chart.BarItem.prototype.load=function(){window.requestAnimationFrame?(this.DrawRate=0,this.loopAnimation()):this.render(this.Left,this.Top,this.Width,this.Height,!1)},sr.Chart.BarItem.prototype.clear=function(){window.cancelAnimationFrame&&(window.cancelAnimationFrame(this.looped),this.looped=null,this.Context.clearRect(this.Left-2.5,this.Top-1,this.Width+5,this.Height+2),this.Left=0,this.Top=0,this.Width=0,this.Height=0)}},sr.Chart.BarLabel=function(t,i){this.Width=120,this.Height=63,this.Parent=t,this.OriPoint={left:this.Parent.Width/2,top:this.Parent.Height/2},this.DstPoint={left:this.Parent.Width/2,top:this.Parent.Height/2},this.DstBar=null,this.OriBar=null,this.Dir=i||"u";var e=document.createElement("canvas");this.Parent.HTML.appendChild(e),this.Canvas=e,this.Context=e.getContext("2d");var a=sr.Chart.BarFactory.getPixelRatio(this.Context)||1;e.width=this.Parent.Width*a,e.height=this.Parent.Height*a,e.style.cssText="height:"+this.Parent.Height+"px;width:"+Number(this.Parent.Width)+"px;position:absolute;",this.Context.scale(a,a),this.isShow=!1;this.Alpha=0,this.speed1=10,this.speed2=15,this.MoveRate=0;var l=this;this.fadeIn=function(){l.loopIn=requestAnimationFrame(l.fadeIn);var t=l.speed1,i=l.speed2,e=l.Alpha,a=l.MoveRate;if(window.cancelAnimationFrame(l.loopOut),100==e&&100==a)return window.cancelAnimationFrame(l.loopIn),l.loopIn=null,void(l.isShow=!0);if(e<100&&(e=100<e+t?100:e+t,l.Canvas.style.opacity=e/100,l.Canvas.style.filter="alpha(opacity="+e/100+")",l.Alpha=e),a<100){var s=l.OriPoint.left,o=l.OriPoint.top,r=l.DstPoint.left-l.OriPoint.left,h=l.DstPoint.top-l.OriPoint.top;a=100<a+i?100:a+i,l.drawBox(s+r*a/100,o+h*a/100),100==(l.MoveRate=a)&&(l.OriBar=l.DstBar,l.OriPoint.left=l.DstPoint.left,l.OriPoint.top=l.DstPoint.top)}},this.fadeOut=function(){l.loopOut=requestAnimationFrame(l.fadeOut);var t=l.speed1,i=l.Alpha;l.loopIn?window.cancelAnimationFrame(l.loopOut):0==i?(window.cancelAnimationFrame(l.loopOut),l.loopOut=null,l.isShow=!1):0<i&&(i=i-t<0?0:i-t,l.Canvas.style.opacity=i/100,l.Canvas.style.filter="alpha(opacity="+i/100+")",l.Alpha=i)},sr.Chart.BarLabel.prototype.show=function(t,i){if(window.requestAnimationFrame)if(t)window.cancelAnimationFrame(this.loopOut),this.loopOut=null,this.loopIn&&(window.cancelAnimationFrame(this.loopIn),this.loopIn=null),this.OriBar!=this.DstBar&&(this.MoveRate=0),this.fadeIn();else{if(i)window.cancelAnimationFrame(this.loopIn),this.loopIn=null,window.cancelAnimationFrame(this.loopOut),this.loopOut=null;else if(this.loopIn||this.loopOut)return;this.fadeOut()}else t?this.Canvas.style.setProperty("display","block"):this.Canvas.style.setProperty("display","none")},sr.Chart.BarLabel.prototype.drawBox=function(t,i){var e=this.Context,a=this.Height,s=this.Width;e.clearRect(0,0,this.Parent.Width,this.Parent.Height);var o=this.DstBar;e.beginPath(),sr.BrowserUtil.isIE()?e.fillStyle="RGB(0,0,0)":e.fillStyle="RGB(0,0,0,0.6)","r"==this.Dir?(e.moveTo(t-5,i+a/2),e.lineTo(t,i+a/2-5),e.lineTo(t,i+5),e.arc(t+5,i+5,5,Math.PI,3*Math.PI/2,!1),e.lineTo(t+s,i),e.arc(t+s-5,i+5,5,-Math.PI/2,0,!1),e.lineTo(t+s,i+a-5),e.arc(t+s-5,i+a-5,5,0,Math.PI/2,!1),e.lineTo(t,i+a),e.arc(t+5,i+a-5,5,Math.PI/2,Math.PI,!1),e.lineTo(t,i+a/2+5),e.lineTo(t-5,i+a/2)):(e.moveTo(t+s/2,i+a+5),e.lineTo(t+s/2-5,i+a),e.lineTo(t+5,i+a),e.arc(t+5,i+a-5,5,Math.PI/2,Math.PI,!1),e.lineTo(t,i+5),e.arc(t+5,i+5,5,Math.PI,Math.PI/2*3,!1),e.lineTo(t+5,i),e.arc(t+s-5,i+5,5,Math.PI/-2,0,!1),e.lineTo(t+s,i+a-5),e.arc(t+s-5,i+a-5,5,0,Math.PI/2,!1),e.lineTo(t+s/2+5,i+a),e.lineTo(t+s/2,i+a+5)),e.fill(),e.closePath(),e.beginPath(),e.fillStyle=o.getFillColor(1),e.rect(t+10,i+8,8,8),e.fill(),e.lineWidth=.5,e.strokeStyle=o.getLineColor(1),e.stroke(),e.closePath(),e.beginPath(),e.fillStyle="rgb(255,255,255)",e.textAlign="left",e.textBaseline="top","S"!=this.Parent.LabelSize?(e.font="bold 12px arial",e.fillText(o.Category,t+25,i+8),e.font="normal 12px arial",e.fillText(o.XName,t+25,i+25),e.fillText(o.YVal,t+25,i+42)):(e.font="normal 12px arial",e.fillText(o.YVal,t+25,i+6)),e.closePath()},sr.Chart.BarLabel.prototype.move=function(t){if(t){var i=this.Context;if(this.Width=40+i.measureText(t.YVal).width,i.font="normal 12px arial","S"==this.Parent.LabelSize)this.Height=25;else{var e=40+i.measureText(t.XName).width;this.Width<e&&(this.Width=e),i.font="bold 12px arial";var a=40+i.measureText(t.Category).width;this.Width<a&&(this.Width=a)}"r"==this.Dir?(this.DstPoint.left=t.Left+t.Width+10,this.DstPoint.top=t.Top-(this.Height-t.Height)/2):(this.DstPoint.left=t.Left+(t.Width-this.Width)/2,this.DstPoint.top=t.Top-this.Height-8),this.DstBar=t,this.show(!0)}else this.show(!1)}},sr.Chart.BarV=function(t){sr.Chart.BarFactory.create(this,t),sr.Chart.BarV.prototype.setSpecialBar=function(t,i){sr.Chart.BarFactory.setSpecialBar(this,t,i)},sr.Chart.BarV.prototype.clear=function(){sr.Chart.BarFactory.clear(this)},sr.Chart.BarV.prototype.draw=function(t){if(!this.isInit)return!1;sr.Chart.BarFactory.set(this,t),this.xLabels=t.xLabels,this.xNames=t.xNames,this.XList=this.xNames||this.xLabels||[],this.Y=t.y||{},this.SpaceH=30;var i=this.Width,e=this.Height,a=this.CtxBack;if(!this.isNoData){sr.Chart.BarFactory.getMaxMin(this,t,this.Y);var s=this.Y.max,o=this.Y.min;this.Y.max=s+this.SpaceH*(s-o)/(e-this.BottomH-this.TopH),s=this.Y.max,o<0?this.Y.min=o-this.SpaceH*(s-o)/(e-this.BottomH-this.TopH):0<o&&(this.Y.min=s<2e3||2*o<s?0:o-this.SpaceH*(s-o)/(e-this.BottomH-this.TopH)),this.Y.min=Number(this.Y.min.toFixed(this.digit)),o=this.Y.min,s=this.Y.max;var r=(e-this.BottomH-this.TopH)/(this.Y.max-this.Y.min),h=this.SpaceH/r;if(h=h.toFixed(this.digit),a.font="11px arial",a.textAlign="left",a.textBaseline="bottom",this.ZeroTop=e-this.BottomH,o<0&&(this.ZeroTop=e-this.BottomH-Math.abs(this.Y.min)*r,a.fillStyle=sr.Chart.ThemeColor.Font(),a.fillRect(20,this.ZeroTop,i-40,1),a.fillStyle=sr.Chart.ThemeColor.Font(),a.fillText(sr.NumUtil.trimBigNum(0,this.digit),20,this.ZeroTop)),this.Y.min<0){for(var l=((s=this.Y.max)-(o=0))/h,n=1;n<l;n++){(f=o+h*n)<=s&&this.ZeroTop-f*r>this.TopH&&(a.fillStyle=sr.Chart.ThemeColor.GridLine(),a.fillRect(20,this.ZeroTop-f*r,i-40,.5),a.fillStyle=sr.Chart.ThemeColor.FontMinor(),a.fillText(sr.NumUtil.trimBigNum(f,this.digit),20,this.ZeroTop-f*r))}s=0,o=this.Y.min;for(l=Math.abs(s-o)/h,n=1;n<l;n++){(f=s-h*n)<s&&this.ZeroTop-f*r>this.BottomH&&(a.fillStyle=sr.Chart.ThemeColor.GridLine(),a.fillRect(20,this.ZeroTop-f*r,i-40,.5),a.fillStyle=sr.Chart.ThemeColor.FontMinor(),a.fillText(sr.NumUtil.trimBigNum(f,this.digit),20,this.ZeroTop-f*r))}}else for(l=(s-o)/h,n=1;n<l;n++){var f;(f=o+h*n)<=s&&e-this.BottomH-h*n*r>this.TopH&&(a.fillStyle=sr.Chart.ThemeColor.GridLine(),a.fillRect(20,e-this.BottomH-h*n*r,i-40,.5),a.fillStyle=sr.Chart.ThemeColor.FontMinor(),a.fillText(sr.NumUtil.trimBigNum(f,this.digit),20,e-this.BottomH-(f-o)*r))}a.beginPath(),a.moveTo(20,e-this.BottomH),a.lineTo(i-20,e-this.BottomH),a.lineWidth=.5,a.strokeStyle=sr.Chart.ThemeColor.Axis(),a.stroke(),0<=this.Y.min&&(a.fillStyle=sr.Chart.ThemeColor.Font(),a.fillText(sr.NumUtil.trimBigNum(this.Y.min,this.digit),20,e-this.BottomH-3)),a.closePath(),a.font="bold 11px arial",a.fillStyle=sr.Chart.ThemeColor.Font(),a.textAlign="center",a.textBaseline="top";var d=(i-60)/(this.XList.length+1);for(n=0;n<this.XList.length;n++)a.fillText(this.XList[n].Label||this.XList[n],d*(n+1)+40,e-this.BottomH+5);sr.Chart.BarFactory.drawLegend(this,t);for(n=0;n<t.data.length;n++){var c=t.data[n];if(c.list){c.BarList=[];for(var m=0;m<this.XList.length&&c.list&&!(m>=c.list.length);m++){var p=new sr.Chart.BarItem(c.category||"category"+(n+1),this.XList[m].LongName||this.XList[m],c.list[m],this);p.Width=d/(2*t.data.length),p.Left=d*(m+1)-p.Width*t.data.length/2+n*p.Width+40,0<p.YVal?(0<this.Y.min?p.Height=(p.YVal-this.Y.min)*r:p.Height=p.YVal*r,p.Top=this.ZeroTop-p.Height):(p.Height=(0-p.YVal)*r,p.Top=this.ZeroTop),c.color&&p.setColor(c.color),c.gradient&&p.setGradientColor(c.gradient),c.BarList[m]=p,this.ChildList.push(c),p.load()}}}this.Label.show(!1),sr.Chart.BarFactory.addEvent(this)}}},sr.Chart.BarH=function(t){sr.Chart.BarFactory.create(this,t,"h"),sr.Chart.BarH.prototype.setSpecialBar=function(t,i){sr.Chart.BarFactory.setSpecialBar(this,t,i)},sr.Chart.BarH.prototype.clear=function(){sr.Chart.BarFactory.clear(this)},sr.Chart.BarH.prototype.draw=function(t){if(!this.isInit)return!1;sr.Chart.BarFactory.set(this,t),this.LabelSize=t.labelsize||"S";var i=this.Width,e=this.Height,a=this.CtxBack;if(this.yLabels=t.yLabels,this.yNames=t.yNames,this.YList=this.yNames||this.yLabels||[],this.X=t.x||{},this.SpaceH=45,!this.isNoData){sr.Chart.BarFactory.getMaxMin(this,t,this.X);var s=this.X.min,o=this.X.max;this.Left=30,this.X.min=s-(o-s)/(i-this.Left-20)*this.SpaceH*1,this.X.min=Number(this.X.min.toFixed(this.digit)),s=this.X.min,this.X.max=o+(o-s)/((i-this.Left-20)/this.SpaceH)*3,o=this.X.max,a.font="normal 11px arial";for(var r=(e-this.TopH-this.BottomH)/(this.YList.length+1),h=0;h<this.YList.length;h++){var l=a.measureText(this.YList[h].Label||this.YList[h]).width;this.Left<l&&(this.Left=l)}if(this.Left+=30,210<this.Left&&(this.Left=210),t.sort&&1==t.data.length&&"desc"==t.sort){var n=t.data[0];for(h=0;h<n.list.length;h++)for(var f=h+1;f<n.list.length;f++)if(n.list[h]<n.list[f]){var d=n.list[f];n.list[f]=n.list[h],n.list[h]=d;var c=this.YList[h].Label||this.YList[h],m=this.YList[f].Label||this.YList[f];this.YList[h].Label?(this.YList[f].Label=c,this.YList[h].Label=m):(this.YList[f]=c,this.YList[h]=m)}}a.beginPath(),a.textBaseline="middle",a.moveTo(this.Left,this.TopH),a.lineTo(this.Left,e-this.BottomH),a.lineWidth=.5,a.font="normal 11px arial",a.strokeStyle=sr.Chart.ThemeColor.Font(),a.stroke(),a.textAlign="right",a.fillText(sr.NumUtil.trimBigNum(this.X.min,this.digit),this.Left,e-this.BottomH/2),a.closePath(),a.fillStyle=sr.Chart.ThemeColor.Font(),a.textAlign="right",a.textBaseline="middle",a.font="bold 11px arial";for(h=0;h<this.YList.length;h++)a.beginPath(),a.fillText(this.YList[h].Label||this.YList[h],this.Left-10,this.TopH+r*(h+1)),a.closePath();var p=(i-this.Left-20)/(o-s),g=this.SpaceH/p,C=(o-s)/(g=g.toFixed(this.digit));if(a.font="11px arial",a.textAlign="center",a.textBaseline="middle",this.ZeroLeft=this.Left,s<0&&(this.ZeroLeft=this.Left+Math.abs(s)*p,a.fillStyle=sr.Chart.ThemeColor.Font(),a.fillRect(this.ZeroLeft-1,this.TopH,1,e-this.TopH-this.BottomH),a.fillStyle=sr.Chart.ThemeColor.Font(),a.fillText(sr.NumUtil.trimBigNum(0,this.digit),this.ZeroLeft,e-this.BottomH/2)),s<0){for(C=((o=this.X.max)-(s=0))/g,h=1;h<C;h++){(L=s+g*h)<=o&&this.ZeroLeft+L*p<i-40&&(a.fillStyle=sr.Chart.ThemeColor.GridLine(),a.fillRect(this.ZeroLeft+L*p,this.TopH,.5,e-this.TopH-this.BottomH),a.fillStyle=sr.Chart.ThemeColor.FontMinor(),a.fillText(sr.NumUtil.trimBigNum(L,this.digit),this.ZeroLeft+L*p,e-this.BottomH/2))}o=0,s=this.X.min;for(C=Math.abs(o-s)/g,h=1;h<C;h++){(L=0-g*h)<o&&this.ZeroLeft+L*p>this.Left&&(a.fillStyle=sr.Chart.ThemeColor.GridLine(),a.fillRect(this.ZeroLeft+L*p,this.TopH,.5,e-this.TopH-this.BottomH),a.fillStyle=sr.Chart.ThemeColor.FontMinor(),a.fillText(sr.NumUtil.trimBigNum(L,this.digit),this.ZeroLeft+L*p,e-this.BottomH/2))}}else for(C=(o-s)/g,h=1;h<C;h++){var L;(L=s+g*h)<=o&&this.Left+(L-s)*p<i-20&&(a.fillStyle=sr.Chart.ThemeColor.GridLine(),a.fillRect(this.Left+(L-s)*p,this.TopH,.5,e-this.TopH-this.BottomH),a.fillStyle=sr.Chart.ThemeColor.FontMinor(),a.fillText(sr.NumUtil.trimBigNum(L,this.digit),this.Left+(L-s)*p,e-this.BottomH/2))}sr.Chart.BarFactory.drawLegend(this,t);for(h=0;h<t.data.length;h++){if((d=t.data[h]).list){d.BarList=[];for(f=0;f<this.YList.length;f++){var B=new sr.Chart.BarItem(d.category||"category"+(h+1),this.YList[f].LongName||this.YList[f],d.list[f],this,!0);0<s?(B.Width=Math.round(p*(B.YVal-this.X.min)),B.Left=this.ZeroLeft):0<B.YVal?(B.Width=Math.round(p*B.YVal),B.Left=this.ZeroLeft):(B.Width=Math.round(p*(0-B.YVal)),B.Left=this.ZeroLeft-B.Width),B.Height=r/(2*t.data.length),B.Top=this.TopH+(r*(f+1)-B.Height*t.data.length/2+h*B.Height),d.color&&B.setColor(d.color),d.gradient&&B.setGradientColor(d.gradient),(d.BarList[f]=B).load(),this.ChildList.push(d)}}}this.Label.show(!1),sr.Chart.BarFactory.addEvent(this)}}};


//pi
sr.Chart.PieItem=function(t,e,i,a,s){this.No=t.num||0,this.Name=t.name||"Pie "+(this.No+1),this.Value=t.value||0,this.Rate=t.rate||0,this.Color=t.ColorSet||new sr.Chart.ColorSet(t.color),this.Parent=i,this.isDrawNum=s||!1,this.AngleS=e||0,this.AngleE=this.AngleS+2*this.Rate*Math.PI,a&&(this.Legend=new sr.LegendItem(this)),sr.Chart.PieItem.prototype.getFillColor=function(t){return this.Color.getFillColor(t)},sr.Chart.PieItem.prototype.getLineColor=function(t){return this.Color.getLineColor(t)},sr.Chart.PieItem.prototype.getFillHighColor=function(t){return this.Color.getFillHighColor(t)},sr.Chart.PieItem.prototype.render=function(t,e){var i=this.Parent.ContextBody;i.lineWidth=1;var a=this.Parent.Radius,s=this.Parent.CenterX,o=this.Parent.CenterY,n=this.Parent.LineWidth,h=this.AngleS+t;i.beginPath(),this.Parent.isPie?(i.lineTo(s,o),i.lineTo(s+Math.cos(this.AngleS)*a,o+Math.sin(this.AngleS)*a),i.arc(s,o,a,this.AngleS,h,!1),i.lineTo(s+Math.cos(h)*a,o+Math.sin(h)*a),i.lineTo(s,o)):(i.lineTo(s+Math.cos(this.AngleS)*(a+n),o+Math.sin(this.AngleS)*(a+n)),i.arc(s,o,a+n,this.AngleS,h,!1),i.lineTo(s+Math.cos(h)*a,o+Math.sin(h)*a),i.arc(s,o,a,h,this.AngleS,!0),i.lineTo(s+Math.cos(this.AngleS)*(a+n),o+Math.sin(this.AngleS)*(a+n))),i.strokeStyle=this.getLineColor(1),"flat"==this.Parent.Style?i.fillStyle=e?this.getFillHighColor(1):this.getFillColor(1):(i.fillStyle=this.getLineColor(1),i.stroke(),i.fillStyle=e?this.getFillHighColor(.6):this.getFillColor(.6)),this.Parent.Shadow?(i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=this.Parent.Shadow.size,i.shadowColor=this.getFillColor(this.Parent.Shadow.alpha)):(i.shadowBlur=0,i.shadowColor=null),i.fill(),i.closePath(),this.isDrawNum&&(i.font=11+(a-25)/5*2+"px Tahoma",i.fillStyle=this.getLineColor(1),i.textAlign="center",i.textBaseline="middle",i.fillText((t/(2*Math.PI)*100).toFixed(2)+" %",s,o,.95*a*2))},sr.Chart.PieItem.prototype.reDraw=function(t,e){this.render(2*this.Rate*Math.PI,t),this.Legend&&this.Legend.render(t,e)},sr.Chart.PieItem.prototype.isEnterIn=function(t,e){var i=t-this.Parent.CenterX,a=e-this.Parent.CenterY,s=this.Parent.Radius,o=this.Parent.LineWidth,n=Math.atan(a/i);i<0&&(n+=Math.PI);var h=!1;return this.Parent.isPie?Math.pow(i,2)+Math.pow(a,2)<=Math.pow(s+8,2)&&n>=this.AngleS&&n<=this.AngleE&&(h=!0):Math.pow(i,2)+Math.pow(a,2)<=Math.pow(s+o+8,2)&&Math.pow(i,2)+Math.pow(a,2)>=Math.pow(s-8,2)&&n>=this.AngleS&&n<=this.AngleE&&(h=!0),this.Legend&&this.Legend.isEnter(t,e)&&(h=!0),h}},sr.LegendItem=function(t){this.PieItem=t,this.Parent=t.Parent,this.isInit=!1,this.Width=120,this.Height=30,this.Left=this.Parent.Width-160,this.Top=this.Parent.TopH+25+this.PieItem.No*this.Height,sr.LegendItem.prototype.render=function(t){var e=this.Parent.ContextFont,i=this.Top,a=this.Height,s=this.Width,o=this.Left;if(e.clearRect(o-20,i-a/2,s+25,a),this.Parent.SelectedItem==this.PieItem){e.fillStyle=sr.Chart.ThemeColor.FontMinor(),e.font="bold 12px arial";var n=e.measureText(this.PieItem.Name||"category"+this.PieItem.No).width;e.fillRect(o,i+10,n,.5)}e.font="12px arial",e.fillStyle=sr.Chart.ThemeColor.Title(),t&&(e.fillStyle=sr.Chart.ThemeColor.Font(),e.font="bold 12px arial"),e.textAlign="left",e.textBaseline="middle",e.fillText(this.PieItem.Name||"category"+this.PieItem.No,o,i,s),this.Width=e.measureText(this.PieItem.Name||"category"+this.PieItem.No).width+5,e.fillStyle=this.PieItem.Color.getFillColor(1),e.strokeStyle=this.PieItem.Color.getLineColor(1),e.lineWidth=.5,e.beginPath(),e.rect(o-15,i-4,6,6),e.fill(),e.stroke(),e.closePath()},this.isInit||this.render(),sr.LegendItem.prototype.isEnter=function(t,e){var i=this.Top,a=this.Height,s=this.Width,o=this.Left;return o-20<t&&t<o+s&&i-a/2<e&&e<i+a/2}},sr.Chart.PieLabel=function(t){this.Parent=t,this.Width=100,this.Height=45,this.TriSize=5,this.OriPoint={left:this.Parent.Width/2,top:this.Parent.Height/2},this.DstPoint={left:this.Parent.Width/2,top:this.Parent.Height/2},this.OriPie=null,this.DstPie=null;var e=document.createElement("canvas");e.style.cssText="width:"+this.Parent.Width+"px;height:"+this.Parent.Height+"px;position:absolute;",this.Parent.HTML.appendChild(e),this.Canvas=e,this.Context=e.getContext("2d");var i=sr.Chart.PieFactory.getPixelRatio(this.Context);e.width=this.Parent.Width*i,e.height=this.Parent.Height*i,this.Context.scale(i,i),this.isShow=!1,this.Alpha=0,this.MoveRate=0,this.speed1=10,this.speed2=15;var l=this;this.fadeIn=function(){l.loopIn=requestAnimationFrame(l.fadeIn);var t=l.speed1,e=l.speed2,i=l.Alpha,a=l.MoveRate;if(100==i&&100==a)return window.cancelAnimationFrame(l.loopIn),l.loopIn=null,void(l.isShow=!0);if(i<100&&(i=100<i+t?100:i+t,l.Canvas.style.opacity=i/100,l.Canvas.style.filter="alpha(opacity="+i/100+")",l.Alpha=i),a<100){var s=l.OriPoint.left,o=l.OriPoint.top,n=l.DstPoint.left-l.OriPoint.left,h=l.DstPoint.top-l.OriPoint.top;a=100<a+e?100:a+e,l.drawBox(s+n*a/100,o+h*a/100),100==(l.MoveRate=a)&&(l.OriPie=l.DstPie,l.OriPoint.left=l.DstPoint.left,l.OriPoint.top=l.DstPoint.top)}},this.fadeOut=function(){l.loopOut=requestAnimationFrame(l.fadeOut);var t=l.speed1,e=l.Alpha;0==e?(window.cancelAnimationFrame(l.loopOut),l.loopOut=null,l.isShow=!1):0<e&&(e=e-t<0?0:e-t,l.Canvas.style.opacity=e/100,l.Canvas.style.filter="alpha(opacity="+e/100+")",l.Alpha=e)},sr.Chart.PieLabel.prototype.show=function(t,e){if(window.requestAnimationFrame)if(t)window.cancelAnimationFrame(this.loopOut),this.loopOut=null,this.loopIn&&(window.cancelAnimationFrame(this.loopIn),this.loopIn=null),this.OriPie!=this.DstPie&&(this.MoveRate=0),this.fadeIn();else{if(e)window.cancelAnimationFrame(this.loopIn),this.loopIn=null,window.cancelAnimationFrame(this.loopOut),this.loopOut=null;else if(this.loopIn||this.loopOut)return;this.fadeOut()}else t?this.Canvas.style.setProperty("display","block"):this.Canvas.style.setProperty("display","none")},this.drawBox=function(t,e){var i=this.Context,a=this.TriSize,s=this.Height,o=this.Width,n=this.DstPie;i.clearRect(0,0,this.Parent.Width,this.Parent.Height),i.beginPath(),sr.BrowserUtil.isIE()?i.fillStyle="RGB(0,0,0)":i.fillStyle="RGB(0,0,0,0.6)",Math.cos((n.AngleS+n.AngleE)/2)<0||1==Math.abs(Math.sin((n.AngleS+n.AngleE)/2))?(i.moveTo(t-a,e+s/2),i.lineTo(t,e+(s/2-a)),i.lineTo(t,e+5),i.arc(t+5,e+5,5,Math.PI,3*Math.PI/2,!1),i.lineTo(t+o-5,e),i.arc(t+o-5,e+5,5,Math.PI/-2,0,!1),i.lineTo(t+o,e+s-5),i.arc(t+o-5,e+s-5,5,0,Math.PI/2,!1),i.lineTo(t,e+s),i.arc(t+5,e+s-5,5,Math.PI/2,Math.PI,!1),i.lineTo(t,e+(s/2+a))):(i.moveTo(t+5,e),i.lineTo(t+o-5,e),i.arc(t+o-5,e+5,5,Math.PI/-2,0,!1),i.lineTo(t+o,e+s/2-a),i.lineTo(t+o+a,e+s/2),i.lineTo(t+o,e+s/2+a),i.lineTo(t+o,e+s-5),i.arc(t+o-5,e+s-5,5,0,Math.PI/2,!1),i.lineTo(t+5,e+s),i.arc(t+5,e+s-5,5,Math.PI/2,Math.PI,!1),i.lineTo(t,e-5),i.arc(t+5,e+5,5,Math.PI,3*Math.PI/2,!1)),i.fill(),i.closePath(),i.beginPath(),i.fillStyle=n.getFillColor(1),i.rect(t+10,e+10,8,8),i.fill(),i.lineWidth=.5,i.strokeStyle=n.getLineColor(1),i.stroke(),i.closePath(),i.beginPath(),i.fillStyle="rgb(255,255,255)",i.font="normal 12px arial",i.textAlign="left",i.textBaseline="top","S"!=this.Parent.LabelSize?(i.fillText(n.Value.toFixed(1)+" , "+(100*n.Rate).toFixed(2)+"%",t+25,e+25),i.font="bold 12px arial",i.fillText(n.Name,t+25,e+8)):(i.fillText(n.Value.toFixed(1),t+25,e+8),i.fillText((100*n.Rate).toFixed(2)+"%",t+25,e+25)),i.closePath()},sr.Chart.PieLabel.prototype.move=function(t){if(t){"S"==this.Parent.LabelSize&&(this.Height=45);var e=this.Parent.CenterY+(this.Parent.Radius+this.Parent.LineWidth/2)*Math.sin((t.AngleS+t.AngleE)/2)-this.Height/2,i=this.Parent.CenterX+(this.Parent.Radius+this.Parent.LineWidth/2)*Math.cos((t.AngleS+t.AngleE)/2),a=this.Context;if("S"!=this.Parent.LabelSize){a.font="bold 12px arial",this.Width=40+a.measureText(t.Name).width,a.font="normal 12px arial";var s=40+a.measureText(t.Value.toFixed(1)+" , "+(100*t.Rate).toFixed(2)+"%").width;this.Width<s&&(this.Width=s)}else{a.font="normal 12px arial",this.Width=40+a.measureText(t.Value.toFixed(1)).width;s=40+a.measureText((100*t.Rate).toFixed(2)+"%").width;this.Width<s&&(this.Width=s)}Math.cos((t.AngleS+t.AngleE)/2)<0||1==Math.abs(Math.sin((t.AngleS+t.AngleE)/2))?i+=this.TriSize:i=i-this.Width-this.TriSize,this.DstPoint.left=i,this.DstPoint.top=e,this.DstPie=t,this.show(!0)}else this.show(!1)}},sr.Chart.PieFactory={getPixelRatio:function(t){var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e},create:function(t,e){t.HTML=e,t.isInit=!1,e.offsetHeight<100&&e.style.setProperty("height","100px"),e.offsetWidth<100&&e.style.setProperty("width","100px"),t.Width=e.offsetWidth,t.Height=e.offsetHeight;var i=document.createElement("canvas");if(!i.getContext)return!(e.innerHTML='<div style="text-align:center;margin:20px auto;line-height:25px;font-size:12px;">Sorry T T. <br />Your browser not support HTML5</div>');i.style.cssText="width:"+t.Width+"px;height:"+t.Height+"px;position:absolute;",e.appendChild(i),t.CanvasBody=i,t.ContextBody=i.getContext("2d");var a=sr.Chart.PieFactory.getPixelRatio(t.ContextBody);i.height=t.Height*a,i.width=t.Width*a,t.ContextBody.scale(a,a),i=document.createElement("canvas"),e.appendChild(i),i.style.cssText="width:"+t.Width+"px;height:"+t.Height+"px;position:absolute;",i.height=t.Height*a,i.width=t.Width*a,t.CanvasFont=i,t.ContextFont=i.getContext("2d"),t.ContextFont.scale(a,a),t.Label=new sr.Chart.PieLabel(t),t.ChildList=[],t.ActivePie=null,t.SelectedItem=null,t.isInit=!0},draw1Frame:function(t,e){if(0!=e&&0!=t.Sum){var i=2*e*Math.PI-Math.PI/2;t.ContextBody.clearRect(0,0,t.Width,t.Height);for(var a=0;a<t.ChildList.length;a++){var s=t.ChildList[a];if(s.AngleS>i)break;s.AngleE<=i?s.render(s.AngleE-s.AngleS,!1):s.render(i-s.AngleS,!1)}}},setSpecialPie:function(t,e,i){var a=null,s=t.ContextBody;if(0!=t.Sum)if("hover"==i?a=t.ActivePie:"click"==i&&(a=t.SelectedItem),e!=a){s.beginPath(),s.clearRect(0,0,t.Width,t.Height),s.closePath(),"hover"==i?t.ActivePie=e:"click"==i&&(t.SelectedItem=e);for(var o=0;o<t.ChildList.length;o++){var n=t.ChildList[o];n==e||n==t.SelectedItem?n.reDraw(!0):n.reDraw(!1)}if("click"==i){t.Label.move(e);var h=t.PieEvent;null!=h&&null!=h&&h(e)}else t.SelectedItem||t.Label.move(e)}else e||("click"==i?t.Label.show(!1):t.SelectedItem||t.Label.show(!1))},set:function(t,e){if(!t.isInit)return!1;t.clear(),t.isPie=e.isPie||!1,t.LineWidth=e.linewidth||15,t.Title=e.title||null,t.Radius=e.radius||60,t.LabelSize=e.labelsize||"L",t.Shadow=e.shadow||null,t.Style=e.style||"normal",t.PieEvent=e.event||null,null!=t.Title?t.TopH=55:t.TopH=0},adjustData:function(t){t.Radius+10>t.CenterX&&(t.CenterX=t.Radius+10),t.Radius+t.TopH+10>t.CenterY&&(t.CenterY=t.Radius+t.TopH+10),t.Radius<25&&(t.Radius=25)},drawTitle:function(t,e,i){if(t.Title&&((a=t.ContextFont).beginPath(),a.clearRect(0,0,t.Width,t.Height),a.closePath(),a.font="20px calibri",a.fillStyle=sr.Chart.ThemeColor.Font(),a.textAlign=e||"center",a.textBaseline="middle",a.fillText(t.Title,i||25,t.TopH/2)),0==t.Sum){var a=t.ContextFont;a.beginPath(),a.fillStyle=sr.Chart.ThemeColor.FontLight(),a.font="normal 20px calibri",a.textAlign="center",a.textBaseline="middle",a.fillText("No Data",t.CenterX,t.CenterY),a.closePath()}},addEvent:function(o){sr.EventUtil.add(o.Label.Canvas,"mousemove",sr.EventUtil.throttle(function(t){for(var e=sr.MouseUtil.getEventPosition(t,o.CanvasBody),i=null,a=0;a<o.ChildList.length;a++){var s=o.ChildList[a];if(s&&s.isEnterIn(e.x,e.y)){i=s;break}}(0<e.x||0<e.y)&&o.setSpecialPie(i,"hover")},120,100),!1),sr.EventUtil.add(o.Label.Canvas,"click",function(t){for(var e=sr.MouseUtil.getEventPosition(t,o.CanvasBody),i=null,a=0;a<o.ChildList.length;a++){var s=o.ChildList[a];if(s&&s.isEnterIn(e.x,e.y)){i=s;break}}o.setSpecialPie(i,"click")})},clear:function(t){var e=t.ContextBody;e.beginPath(),e.clearRect(0,0,t.Width,t.Height),e.closePath(),(e=t.ContextFont).beginPath(),e.clearRect(0,0,t.Width,t.Height),e.closePath(),t.Label.show(!1);for(var i=0;i<t.ChildList.length;i++){var a=t.ChildList[i];window.cancelAnimationFrame&&(window.cancelAnimationFrame(a.looped),a.looped=null)}t.ChildList.length=0}},sr.Chart.Pie=function(t){sr.Chart.PieFactory.create(this,t),this.AnimateRate=0,this.speed=5;var i=this;sr.Chart.Pie.prototype.clear=function(){sr.Chart.PieFactory.clear(this)},this.loopAnimation=function(){i.looped=requestAnimationFrame(i.loopAnimation);var t=i.speed,e=i.AnimateRate;e<100?(e=100<e+t?100:e+t,sr.Chart.PieFactory.draw1Frame(i,e/100),i.AnimateRate=e):(window.cancelAnimationFrame(i.looped),i.looped=null)},sr.Chart.Pie.prototype.setSpecialPie=function(t,e){sr.Chart.PieFactory.setSpecialPie(this,t,e)},sr.Chart.Pie.prototype.render=function(t){if(!this.isInit)return!1;if(sr.Chart.PieFactory.set(this,t),this.CenterX=t.X||this.Radius+35,this.CenterY=t.Y||this.Height/2+this.TopH/2||this.Radius+this.TopH+this.LineWidth,sr.Chart.PieFactory.adjustData(this),this.Sum=0,t.list){for(var e=0;e<t.list.length;e++)this.Sum+=t.list[e].value;for(e=0;e<t.list.length;e++)for(var i=e+1;i<t.list.length;i++)if(t.list[e].value<t.list[i].value){var a=t.list[i];t.list[i]=t.list[e],t.list[e]=a}for(e=0;e<t.list.length;e++){a=t.list[e];0<this.Sum?a.rate=a.value/this.Sum:a.rate=0}}sr.Chart.PieFactory.drawTitle(this,"left");var s=0,o=-Math.PI/2;if(this.ChildList.length=0,t.list){for(e=0;e<t.list.length;e++){a=t.list[e];var n=new sr.Chart.ColorSet("blue");t.color&&null!=t.color?(n=new sr.Chart.ColorSet(t.color,e+1),t.list.ColorSet=n):n=new sr.Chart.ColorSet(a.color),a.ColorSet=n,a.num=e;var h=new sr.Chart.PieItem(a,o,this,!0);if(this.ChildList.push(h),0!=this.Sum){s+=h.Value,o=-Math.PI/2+s/this.Sum*2*Math.PI;var l=h.AngleE-h.AngleS;window.requestAnimationFrame||h.render(l)}}window.requestAnimationFrame&&(this.AnimateRate=0,this.loopAnimation()),sr.Chart.PieFactory.addEvent(this)}}},sr.Chart.PercentPie=function(t){sr.Chart.PieFactory.create(this,t),this.AnimateRate=0,this.speed=5;var i=this;sr.Chart.PercentPie.prototype.clear=function(){sr.Chart.PieFactory.clear(this)},this.loopAnimation=function(){i.looped=requestAnimationFrame(i.loopAnimation);var t=i.speed,e=i.AnimateRate;e<100?(e=100<e+t?100:e+t,sr.Chart.PieFactory.draw1Frame(i,e/100),i.AnimateRate=e):(window.cancelAnimationFrame(i.looped),i.looped=null)},sr.Chart.PercentPie.prototype.setSpecialPie=function(t,e){sr.Chart.PieFactory.setSpecialPie(this,t,e)},sr.Chart.PercentPie.prototype.render=function(t){if(!this.isInit)return!1;t.labelsize=t.labelsize||"S",sr.Chart.PieFactory.set(this,t),this.Name=t.name||"",this.Sum=t.sum||0,this.Val=t.value||0,this.Color=t.color||"blue",this.CenterX=t.X||this.Width/2||this.Radius+25,this.CenterY=t.Y||(this.Height-this.TopH)/2+this.TopH||this.Radius+this.TopH+this.LineWidth,sr.Chart.PieFactory.adjustData(this),this.Sum>=this.Val?this.Rate=this.Val/this.Sum:(this.Rate=1,this.Val=this.Sum),sr.Chart.PieFactory.drawTitle(this,"center",this.Width/2),this.ChildList.length=0;var e={name:this.Name,value:this.Val,rate:this.Rate,color:this.Color},i=new sr.Chart.PieItem(e,-Math.PI/2,this,!1,!0);this.ChildList.push(i);var a=i.AngleE- -Math.PI/2;window.requestAnimationFrame||i.render(a),e={name:"Other",value:this.Sum-this.Val,rate:1-this.Rate,color:"gray"};var s=-Math.PI/2+this.Val/this.Sum*2*Math.PI;i=new sr.Chart.PieItem(e,s,this,!1),this.ChildList.push(i),a=i.AngleE-i.AngleS,window.requestAnimationFrame||i.render(a),window.requestAnimationFrame&&(this.AnimateRate=0,this.loopAnimation()),sr.Chart.PieFactory.addEvent(this)}};


//pg
sr.Pagination=function(e,a){this.Wrapper=e,this.PerPageList=a.PerPageList||[20,50,100],this.PerPage=a.PerPage||20,this.MaxPage=a.MaxPage||1,this.CurPage=1,this.TurnPageEvent=a.TurnPageEvent||null,this.SetMaxPageEvent=a.MaxPageEvent||null,e.style.cssText="display:none;",e.className="pagination";var t=document.createElement("ul");t.className="pagination-select",e.appendChild(t),this.PageSelect=t;var n=document.createElement("div");n.className="pagination-info",e.appendChild(n),this.PageInfo=n;var i=document.createElement("span");i.className="pagination-info-inputbox",i.innerHTML="Go to";var s=document.createElement("input");s.setAttribute("type","text"),i.appendChild(s),n.appendChild(i),this.PageJumpInput=s,(i=document.createElement("span")).className="pagination-info-space",n.appendChild(i);var l=document.createElement("i");i.appendChild(l),(i=document.createElement("span")).className="pagination-info-size",n.appendChild(i),(n=document.createElement("div")).className="pagination-drop-down",i.appendChild(n);var o=document.createElement("span");o.className="drop-down-box",n.appendChild(o),this.DropDownBox=o;var r=document.createElement("span");r.className="content",r.innerHTML=this.PerPage+" / Page",o.appendChild(r),this.DropDownBoxInner=r,(r=document.createElement("span")).className="icon",o.appendChild(r),l=document.createElement("i"),r.appendChild(l),(t=document.createElement("ul")).className="drop-down-list",t.style.cssText="display:none;",n.appendChild(t),this.DropDownList=t;for(var c=0;c<this.PerPageList.length;c++){var p=document.createElement("li");p.className="drop-down-item",p.setAttribute("data-value",this.PerPageList[c]),p.innerHTML=this.PerPageList[c]+" / Page",t.appendChild(p)}e.style.cssText="display:block;";var d=this;sr.Pagination.prototype.turnPage=function(e,a){this.MaxPage=a||this.MaxPage,a=this.MaxPage,e=Number(e),isNaN(e)?e=this.CurPage:(e<1&&(e=1),a<e&&(e=a),this.CurPage=e),this.TurnPageEvent&&this.TurnPageEvent()},sr.Pagination.prototype.setMaxPage=function(e){this.PageSelect.innerHTML="",this.MaxPage=e,(n=document.createElement("li")).className="pagination-select-li",this.PageSelect.appendChild(n),(t=document.createElement("a")).className="pagination-select-btn pagination-select-btn-prev",n.appendChild(t);for(var a=1;a<=e;a++){var t;if(1==a||a==e||Math.abs(this.CurPage-a)<=2)(n=document.createElement("li")).className="pagination-select-li",this.PageSelect.appendChild(n),(t=document.createElement("a")).className="pagination-select-item",t.innerHTML=a,n.appendChild(t),a==this.CurPage&&(t.className="pagination-select-item choosed");else if(3==Math.abs(a-this.CurPage)&&1!=a&&a!=e){var n;(n=document.createElement("li")).className="pagination-select-li",n.innerHTML="...",this.PageSelect.appendChild(n)}}(n=document.createElement("li")).className="pagination-select-li",this.PageSelect.appendChild(n),(t=document.createElement("a")).className="pagination-select-btn pagination-select-btn-next",n.appendChild(t)},sr.EventUtil.add(this.PageSelect,"click",function(e){var a=e||window.event,t=a.srcElement||a.target;if("A"==t.nodeName)if("pagination-select-item"==t.className)d.turnPage(Number(t.innerHTML));else if(0<=t.className.indexOf("pagination-select-btn")){var n=d.CurPage;0<=t.className.indexOf("pagination-select-btn-next")?n=Number(d.CurPage)+1:0<=t.className.indexOf("pagination-select-btn-prev")&&(n=Number(d.CurPage)-1),d.turnPage(n)}}),sr.EventUtil.add(this.PageInfo,"click",function(e){var a=e||window.event,t=a.srcElement||a.target,n=!1;"SPAN"==t.nodeName?"drop-down-box"!=t.parentNode.className&&"drop-down-box"!=t.className||(n=!0):"I"==t.nodeName&&"drop-down-box"==t.parentNode.parentNode.className&&(n=!0),n&&(d.DropDownList.style.cssText="display:block",e.stopPropagation?e.stopPropagation():e.cancelBubble=!0),"LI"==t.nodeName&&"drop-down-item"==t.className&&(d.DropDownBoxInner.innerHTML=t.innerHTML,d.PerPage=t.getAttribute("data-value"),d.turnPage(1))}),sr.EventUtil.add(document,"click",function(e){d.DropDownList.style.cssText="display:none"}),sr.EventUtil.add(this.PageJumpInput,"blur",function(e){isNaN(d.PageJumpInput.value)||d.turnPage(Number(d.PageJumpInput.value))})};


//tbl
sr.TableTitleItem=function(t,e,i,l){if(this.Id=i.id,this.Name=i.name||"",this.No=e||0,this.Action=i.action||null,this.Link=i.link||null,this.Width=i.width||30,this.hasSearch=i.search||!1,this.Tags=i.tags||[],this.Align=i.align||"",this.DataType=i.datatype||"",this.AsymcLoadFilter=i.asyfilter||!1,this.selectVal=[],this.unselectVal=[],this.filterCount=0,this.selectAll=!0,0<this.Width&&this.Width<15&&(this.Width=15),this.Parent=t,this.Sortable=i.sortable||!1,this.Filterable=i.filterable||!1,this.WrapperWidth=this.Width,this.Sortable&&(this.WrapperWidth+=28),this.Filterable&&(this.WrapperWidth+=28),this.FilterList=[],i.filterlist)for(var a=0;a<i.filterlist.length;a++)i.filterlist[a].name?this.FilterList.push(i.filterlist[a]):this.FilterList.push({name:i.filterlist[a],selected:!0});this.SortMode="";var s=document.createElement("th");s.className="data-table-head-item",s.setAttribute("data-id",this.Id),this.Html=s,0<this.Width&&sr.StyleUtil.set(s,"width",this.WrapperWidth+"px"),l.appendChild(s);var r=document.createElement("span");r.className="data-table-head-item-span",r.innerHTML=this.Name,0<this.Width&&sr.StyleUtil.set(r,"width",this.Width+"px"),s.appendChild(r),this.Sortable&&((r=document.createElement("span")).className="data-table-head-item-span data-table-head-item-sort",s.appendChild(r),(a=document.createElement("i")).className="data-table-head-item-sort-asc",r.appendChild(a),this.SortBtnAsc=a,(a=document.createElement("i")).className="data-table-head-item-sort-desc",r.appendChild(a),this.SortBtnDesc=a);if(this.Filterable){(r=document.createElement("span")).className="data-table-head-item-span data-table-head-item-filter",s.appendChild(r);a=document.createElement("i");r.appendChild(a),this.FilterBtn=a}sr.TableTitleItem.prototype.setWidth=function(t){var e=this.Width-t;this.Width=t,this.WrapperWidth=this.WrapperWidth-e,sr.StyleUtil.set(this.Html,"width",+this.WrapperWidth+"px");var i=this.Html.children[0];sr.StyleUtil.set(i,"width",+this.Width+"px"),this.No<this.Parent.FixColNo&&(this.Parent.FixedWidth-=e);var l=0,a=this.Parent.TitleList;this.Parent.hasNo&&(l=this.Parent.TitleNo.WrapperWidth+20);for(var s=0;s<a.length;s++)l+=a[s].WrapperWidth+20;this.Parent.FixedBody&&l>this.Parent.Wrapper.offsetWidth?sr.StyleUtil.set(this.Parent.FixedBody,"height",this.Parent.Height-17+"px"):sr.StyleUtil.set(this.Parent.FixedBody,"height",this.Parent.Height+"px")},sr.TableTitleItem.prototype.setSort=function(t){if(t=t||"",this.Sortable)if("asc"==t||"desc"==t)switch(this.SortMode=t){case"asc":this.SortBtnAsc.className="data-table-head-item-sort-asc_on",this.SortBtnDesc.className="data-table-head-item-sort-desc";break;case"desc":this.SortBtnDesc.className="data-table-head-item-sort-desc_on",this.SortBtnAsc.className="data-table-head-item-sort-asc"}else this.SortMode="",this.SortBtnAsc.className="data-table-head-item-sort-asc",this.SortBtnDesc.className="data-table-head-item-sort-desc"},sr.TableTitleItem.prototype.resetFilterList=function(){if(this.Filterable){this.selectVal=[],this.unselectVal=[],this.selectAll=!0;for(var t=0;t<this.FilterList.length;t++)this.FilterList[t].selected=!0;this.FilterBtn.className=""}},sr.TableTitleItem.prototype.setFilterList=function(t){if(this.Filterable&&(t=t||null)){if(t.all){this.FilterList.length=0;for(var e=t.all,i=0;i<e.length;i++)this.FilterList.push({name:e[i],selected:!0,hide:!1})}else if(t.add)for(e=t.add,i=0;i<e.length;i++)this.FilterList.push({name:e[i],selected:!0,hide:!1});if(t.hide){e=t.hide;var l=!1;for(i=0;i<this.FilterList.length;i++){l=!1;for(var a=0;a<e.length;a++)if(e[a]==this.FilterList[i].name){l=this.FilterList[i].hide=!0;break}l||(this.FilterList[i].hide=!1)}}}},sr.TableTitleItem.prototype.isSelectAll=function(){if(this.AsymcLoadFilter)return 0==this.selectVal.length&&0==this.unselectVal.length?this.selectAll?1:0:0<this.unselectVal.length?this.unselectVal.length<this.filterCount?.5:0:0<this.selectVal.length?this.selectVal.length<this.filterCount?.5:1:void 0;for(var t=0,e=0,i=0;i<this.FilterList.length;i++)this.FilterList[i].selected?t++:e++;return t==this.FilterList.length?1:e==this.FilterList.length?0:.5}},sr.DataTable=function(t,e){this.ParentHtml=t,this.FixColNo=e.FixCol||0,this.FixedWidth=0,this.Height=e.Height||200,this.TitleList=[],this.MenuMaxNum=e.MaxMenuNum||15,this.ColDraggable=e.ColDraggable||!1,this.hasNo=e.hasNo||!1,this.hideTitle=e.hideTitle||!1,this.LoadEvent=e.loadEvent||null,this.LoadFiltetEvent=e.loadFilterEvent||null,this.isFilterChanged=!1,this.FilterColNo=0;var i=document.createElement("div");if(i.className="data-table",sr.StyleUtil.set(i,"display","none"),t.appendChild(i),this.Wrapper=i,0<this.FixColNo||this.hasNo){(i=document.createElement("div")).className="data-table-fix",this.Wrapper.appendChild(i),this.FixedPart=i,(i=document.createElement("div")).className="data-table-head",this.hideTitle&&(i.style.cssText="display:none"),this.FixedPart.appendChild(i),this.FixedHead=i;var l=document.createElement("table");i.appendChild(l);var a=document.createElement("tbody");l.appendChild(a);var s=document.createElement("tr");if(a.appendChild(s),this.hasNo){var r=new sr.TableTitleItem(this,-1,{id:"No",name:"#",width:25},s);this.TitleNo=r,this.FixedWidth+=r.WrapperWidth+20}for(var d=0;d<this.FixColNo;d++){r=new sr.TableTitleItem(this,d,e.Title[d],s);this.TitleList.push(r),this.FixedWidth+=r.WrapperWidth+20}(i=document.createElement("div")).className="data-table-body",sr.StyleUtil.set(i,"height",this.Height+"px"),this.FixedPart.appendChild(i),this.FixedBody=i;l=document.createElement("table");i.appendChild(l),this.FixedTable=l,sr.StyleUtil.set(l,"width",this.FixedWidth+"px")}(i=document.createElement("div")).className="data-table-scroll",this.Wrapper.appendChild(i),this.ScrollPart=i,(i=document.createElement("div")).className="data-table-head",this.hideTitle&&(i.style.cssText="display:none"),this.ScrollPart.appendChild(i),this.ScrollHead=i;l=document.createElement("table");i.appendChild(l);a=document.createElement("tbody");if(l.appendChild(a),(s=document.createElement("tr")).className="data-table-head-tr",a.appendChild(s),0<this.FixedWidth){var n=document.createElement("th");sr.StyleUtil.set(n,"width",this.FixedWidth+"px"),s.appendChild(n)}for(d=this.FixColNo;d<e.Title.length;d++){r=new sr.TableTitleItem(this,d,e.Title[d],s);this.TitleList.push(r)}n=document.createElement("th"),sr.StyleUtil.set(n,"width","17px"),s.appendChild(n),n=document.createElement("th"),s.appendChild(n),(i=document.createElement("div")).className="data-table-body",sr.StyleUtil.set(i,"height",this.Height+"px"),this.ScrollPart.appendChild(i),this.ScrollBody=i;l=document.createElement("table");i.appendChild(l),this.ScrollTable=l,sr.StyleUtil.set(this.Wrapper,"display","block"),this.DefaultNoData=document.createElement("div"),this.DefaultNoData.style.cssText="line-height:60px;text-align:center;display:none;font-size:14px;color:#ccc;",this.DefaultNoData.innerHTML="No data",i.appendChild(this.DefaultNoData),this.TableLoading=new sr.LoadingCircle(i,100),sr.DataTable.prototype.adjustWidth=function(){for(var t=0,e=0;e<this.TitleList.length;e++)t+=this.TitleList[e].WrapperWidth+20;this.hasNo&&(t+=this.TitleNo.WrapperWidth+20),this.FixedBody&&t>this.Wrapper.offsetWidth&&sr.StyleUtil.set(this.FixedBody,"height",this.Height-17+"px")},this.adjustWidth(),(i=document.createElement("div")).className="data-filter",sr.StyleUtil.set(i,"display","none"),this.ParentHtml.appendChild(i),this.FilterMenu=i,(i=document.createElement("div")).className="data-filter-search",this.FilterMenu.appendChild(i),(this.FilterSearch=i).innerHTML="<i></i>";var o=document.createElement("input");o.setAttribute("type","text"),i.appendChild(o),this.FilterSearchInput=o;var h=document.createElement("a");h.className="data-filter-btn",i.appendChild(h),h.innerHTML='<i class="data-filter-btn-ok"></i>',(h=document.createElement("a")).className="data-filter-btn",i.appendChild(h),h.innerHTML='<i class="data-filter-btn-del"></i>',(i=document.createElement("div")).className="data-filter-select-all all",this.FilterMenu.appendChild(i),i.innerHTML="<i></i><span>All</span>",this.FilterAllBar=i,(i=document.createElement("div")).className="data-filter-list",this.FilterList=i,this.FilterMenu.appendChild(i);var c=document.createElement("ul");c.className="data-filter-list-ul",i.appendChild(c),this.FilterMenuUl=c,this.FilterLoading=new sr.LoadingCircle(i,1e3);var m=this;sr.DataTable.prototype.scrollTblBody=function(){m.ScrollHead.scrollLeft=m.ScrollBody.scrollLeft,m.FixedBody&&(m.FixedBody.scrollTop=m.ScrollBody.scrollTop),sr.StyleUtil.set(m.FilterMenu,"display","none")},sr.EventUtil.add(this.ScrollBody,"scroll",sr.EventUtil.throttle(m.scrollTblBody,10,10)),sr.EventUtil.add(this.Wrapper,"click",function(t){var e=t||window.event,i=e.srcElement||e.target,l=m.TitleList;if("I"==i.nodeName){var a="";if(i.parentNode&&i.parentNode.parentNode&&(a=i.parentNode.parentNode.getAttribute("data-id")),0==a.length)return;if(0<=i.className.indexOf("data-table-head-item-sort")){var s="";switch(i.className){case"data-table-head-item-sort-asc":s="asc";break;case"data-table-head-item-sort-desc":s="desc"}for(var r=0;r<l.length;r++)if(l[r].Id==a){l[r].setSort(s);break}m.LoadEvent&&m.LoadEvent()}if(0<=i.parentNode.className.indexOf("data-table-head-item-filter"))for(r=0;r<l.length;r++){if((h=l[r]).Id==a&&(0<h.FilterList.length||h.AsymcLoadFilter)){m.FilterColNo=r,m.FilterSearchInput.value="",m.showFilterItem(0),h.hasSearch?sr.StyleUtil.set(m.FilterSearch,"display","block"):sr.StyleUtil.set(m.FilterSearch,"display","none");var d=h.isSelectAll();1==d?m.FilterAllBar.className="data-filter-select-all all":0==d?m.FilterAllBar.className="data-filter-select-all no":.5==d&&(m.FilterAllBar.className="data-filter-select-all part"),r>=m.FixColNo?m.FilterMenu.style.cssText="display:block;left:"+(h.Html.offsetLeft+m.Wrapper.offsetLeft-m.ScrollBody.scrollLeft)+"px;top:"+(m.Wrapper.offsetTop+48)+"px":m.FilterMenu.style.cssText="display:block;left:"+(h.Html.offsetLeft+m.Wrapper.offsetLeft)+"px;top:"+(m.Wrapper.offsetTop+48)+"px",t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;break}}}else if("TD"==i.nodeName||"TD"==i.parentNode.nodeName||"TD"==i.parentNode.parentNode.nodeName||"TD"==i.parentNode.parentNode.parentNode.nodeName){var n=i;"TD"==i.parentNode.nodeName?n=i.parentNode:"TD"==i.parentNode.parentNode.nodeName?n=i.parentNode.parentNode:"TD"==i.parentNode.parentNode.parentNode.nodeName&&(n=i.parentNode.parentNode.parentNode);var o=n.getAttribute("data-col"),h=m.TitleList[o],c=n.parentNode.getAttribute("data-id");h.Action&&h.Action(c)}}),sr.DataTable.prototype.hoverRow=function(t){var e=t||window.event;try{var i=e.srcElement||e.target,l=0;if("TD"!=i.nodeName)return;if(i.parentNode){l=i.parentNode.getAttribute("data-row");var a=i.getAttribute("data-col");if(a){var s=m.TitleList[a];s&&s.Action&&sr.StyleUtil.set(i,"cursor","pointer")}}this.ActiveNo&&-1<this.ActiveNo&&this.ActiveNo<this.ScrollRows.length&&(this.FixedRows[this.ActiveNo]&&(this.FixedRows[this.ActiveNo].className=""),this.ScrollRows[this.ActiveNo].className=""),this.FixedRows[l]&&(this.FixedRows[l].className="data-table-row_on"),this.ScrollRows[l]&&(this.ScrollRows[l].className="data-table-row_on"),this.ActiveNo=l,sr.StyleUtil.del(m.Wrapper,"cursor"),m.MoveHeadCol=-1}catch(t){console.log("Fail to hover row"),console.log(t)}},sr.EventUtil.add(this.ScrollTable,"mousemove",sr.EventUtil.throttle(function(t){m.hoverRow(t)},50,50)),this.FixedTable&&sr.EventUtil.add(this.FixedTable,"mousemove",sr.EventUtil.throttle(function(t){m.hoverRow(t)},50,50)),this.ColDraggable&&(sr.DataTable.prototype.hoverHead=function(t,e){var i=sr.MouseUtil.getLayerPosition(t),l=this.TitleList,a=!1;if(e)var s=this.FixColNo,r=0;else s=l.length,r=this.FixColNo;if(!(-1<this.MoveHeadCol&&this.onDrag)){for(var d=r;d<s;d++){var n=l[d].Html.offsetLeft+l[d].Html.offsetWidth;if(Math.abs(n-i.x)<3){sr.StyleUtil.set(this.Wrapper,"cursor","col-resize"),a=!0,this.MoveHeadCol=d;break}}this.onDrag||a||(sr.StyleUtil.del(this.Wrapper,"cursor"),this.MoveHeadCol=-1)}},this.FixedHead&&sr.EventUtil.add(this.FixedHead,"mousemove",sr.EventUtil.throttle(function(t){m.hoverHead(t,!0)},100,100)),sr.EventUtil.add(this.ScrollHead,"mousemove",sr.EventUtil.throttle(function(t){m.hoverHead(t)},100,100)),sr.EventUtil.add(this.Wrapper,"mousedown",function(t){m.onDrag=!0,-1<m.MoveHeadCol&&(m.DragStart=sr.MouseUtil.getLayerPosition(t).x)}),sr.EventUtil.add(this.Wrapper,"mouseup",function(t){sr.StyleUtil.del(m.Wrapper,"cursor"),m.onDrag=!1;var e=t||window.event,i=e.srcElement||e.target,l=m.MoveHeadCol;if(-1<l){m.DragEnd=sr.MouseUtil.getLayerPosition(t).x,"I"==i.nodeName?m.DragEnd+=i.parentNode.offsetLeft+i.parentNode.parentNode.offsetLeft:"SPAN"==i.nodeName&&(m.DragEnd+=i.parentNode.offsetLeft);var a=m.DragEnd-m.DragStart,s=m.TitleList[l];s.WrapperWidth+a<50&&(a=50-s.WrapperWidth),s.setWidth(s.Width+a);var r=m.FixColNo;if(l<r){for(var d=m.FixedBody.children[0],n=d.children[0].children,o=0;o<n.length;o++){var h=n[o].children[l];if(m.hasNo)h=n[o].children[l+1];sr.StyleUtil.set(h,"width",s.WrapperWidth+"px")}var c=sr.StyleUtil.get(d,"width");c=c.replace("px",""),c=Number(c),sr.StyleUtil.set(d,"width",c+a+"px"),d=m.FixedHead.children[0],sr.StyleUtil.set(d,"width",c+a+"px");var p=(d=m.ScrollHead.children[0]).children[0].children[0].children[0];c=(c=sr.StyleUtil.get(p,"width")).replace("px",""),c=Number(c),sr.StyleUtil.set(p,"width",c+a+"px");for(n=(d=m.ScrollBody.children[0]).children[0].children,o=0;o<n.length;o++)sr.StyleUtil.set(n[o].children[0],"width",c+a+"px")}else for(n=(d=m.ScrollBody.children[0]).children[0].children,o=0;o<n.length;o++)sr.StyleUtil.set(n[o].children[l-r+1],"width",s.WrapperWidth+"px");m.MoveHeadCol=-1}}),sr.EventUtil.add(this.Wrapper,"selectstart",function(t){m.onDrag&&-1<m.MoveHeadCol&&(t.returnValue=!1)})),sr.DataTable.prototype.loadFilterStatic=function(t){var e=this.FilterMenuUl,i=this.MenuMaxNum,l=this.TitleList[this.FilterColNo],a=this.FilterSearchInput.value.toLowerCase();i-1<t&&((n=document.createElement("li")).className="data-filter-more up",n.innerHTML="<span>Previous ... "+(t-i)+"~"+(t-1)+"</span>",e.appendChild(n));for(var s=l.FilterList,r=0,d=0;d<s.length;d++)if(!(s[d].hide||0<a.length&&-1==s[d].name.toLowerCase().indexOf(a)||++r<t||!(r<t+i))){var n=document.createElement("li");s[d].selected?n.className="data-filter-item choosed":n.className="data-filter-item",n.setAttribute("data-num",d),n.setAttribute("data-order",r),n.innerHTML="<i></i><span>"+s[d].name+"</span>",e.appendChild(n)}t+i<r&&((n=document.createElement("li")).className="data-filter-more down",n.innerHTML="<span>Next ... "+(t+i)+"~"+(t+2*i-1)+"</span>",e.appendChild(n))},sr.DataTable.prototype.showFilterItem=function(d){var n=this.FilterMenuUl;n.innerHTML="",sr.StyleUtil.del(this.FilterList,"height");var o=this.TitleList[this.FilterColNo];if(o.AsymcLoadFilter){sr.StyleUtil.set(this.FilterList,"height","160px"),this.FilterLoading.start();var h=this.MenuMaxNum,c=d+h-1,t={};t.Id=o.Id,t.start=d,t.end=c,t.key=this.FilterSearchInput.value.toLowerCase(),t.current=this.getFilterFields();var p=this;this.LoadFiltetEvent(t,function(t){if(t.list.all)return o.setFilterList(t.list),o.AsymcLoadFilter=!1,p.loadFilterStatic(d),void p.FilterLoading.stop();o.FilterList.length=0,o.setFilterList(t.list),h<d&&((a=document.createElement("li")).className="data-filter-more up",a.innerHTML="<span>Previous ... "+(d-h+1)+"~"+d+"</span>",n.appendChild(a));o.filterCount=t.count;for(var e=t.list.add,i=!1,l=0;l<e.length;l++){var a=document.createElement("li"),s=!1;if(o.selectAll){for(var r=0;r<o.unselectVal.length;r++)if(o.unselectVal[r]==e[l]){i=!(s=!1);break}}else for(r=0;r<o.selectVal.length;r++)if(o.selectVal[r]==e[l]){i=s=!0;break}i||(s=o.selectAll),a.className=s?"data-filter-item choosed":"data-filter-item",a.setAttribute("data-num",l),a.setAttribute("data-order",d+l),a.innerHTML="<i></i><span>"+e[l]+"</span>",n.appendChild(a)}o.filterCount>1+c&&((a=document.createElement("li")).className="data-filter-more down",a.innerHTML="<span>Next ... "+(2+c)+"~"+(c+h+1)+"</span>",n.appendChild(a)),p.FilterLoading.stop()})}else this.loadFilterStatic(d)},sr.EventUtil.add(this.FilterMenuUl,"click",function(t){var e=t||window.event,i=e.srcElement||e.target,l=0,a=i;if("I"==i.nodeName||"SPAN"==i.nodeName)i.parentNode&&(a=i.parentNode);else{if("LI"!=i.nodeName)return;a=i}if(0<=a.className.indexOf("data-filter-item")){l=a.getAttribute("data-num");var s=!(m.isFilterChanged=!0),r=m.TitleList[m.FilterColNo],d=r.FilterList[l].name;if(0<=a.className.indexOf("choosed")){if(a.className="data-filter-item",r.AsymcLoadFilter)if(r.selectAll)r.unselectVal.push(d);else for(var n=0;n<r.selectVal.length;n++)if(r.selectVal[n]==d){r.selectVal.splice(n,1);break}}else if(a.className="data-filter-item choosed",s=!0,r.AsymcLoadFilter)if(r.selectAll){for(n=0;n<r.unselectVal.length;n++)if(r.unselectVal[n]==d){r.unselectVal.splice(n,1);break}}else r.selectVal.push(d);switch(r.FilterList[l].selected=s,r.isSelectAll()){case 1:m.FilterAllBar.className="data-filter-select-all all";break;case 0:m.FilterAllBar.className="data-filter-select-all no";break;case.5:m.FilterAllBar.className="data-filter-select-all part"}}else if(0<=a.className.indexOf("data-filter-more")){var o=m.FilterMenuUl,h=0,c=m.MenuMaxNum;if(h=0<=o.childNodes[0].className.indexOf("data-filter-item")?o.childNodes[0].getAttribute("data-order"):o.childNodes[1].getAttribute("data-order"),h=Number(h),0<=a.className.indexOf("down"))var p=h+c;else if(0<=a.className.indexOf("up"))p=h-c;m.showFilterItem(p)}t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},!1),sr.EventUtil.add(this.FilterAllBar,"click",function(t){var e=t||window.event,i=(e.srcElement||e.target,m.TitleList[m.FilterColNo]),l=m.FilterAllBar,a=m.FilterMenuUl.children;if(m.isFilterChanged=!0,"data-filter-select-all all"==l.className){i.selectAll=!1,l.className="data-filter-select-all no";for(var s=0;s<a.length;s++)"data-filter-item choosed"==a[s].className&&(a[s].className="data-filter-item")}else{i.selectAll=!0,l.className="data-filter-select-all all";for(s=0;s<a.length;s++)"data-filter-item"==a[s].className&&(a[s].className="data-filter-item choosed")}if(i.AsymcLoadFilter)i.selectVal=[],i.unselectVal=[];else for(s=0;s<i.FilterList.length;s++)i.FilterList[s].selected=i.selectAll;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}),sr.EventUtil.add(this.FilterSearch,"click",function(t){var e=t||window.event,i=e.srcElement||e.target;"data-filter-btn-del"==i.className&&(m.FilterSearchInput.value="",m.showFilterItem(0)),"data-filter-btn-ok"==i.className&&m.showFilterItem(0),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},!1),sr.EventUtil.add(document,"click",function(t){if("block"==sr.StyleUtil.get(m.FilterMenu,"display")){sr.StyleUtil.set(m.FilterMenu,"display","none"),m.FilterLoading.stop();var e=m.TitleList[m.FilterColNo],i=e.isSelectAll();e.FilterBtn.className=1==i?"":"data-table-head-item-filter_on",m.isFilterChanged&&m.LoadEvent&&m.LoadEvent(),m.isFilterChanged=!1,m.adjustWidth()}}),sr.EventUtil.add(window,"resize",function(t){m.adjustWidth()}),sr.DataTable.prototype.wait=function(){this.FixedRows=[],this.ScrollRows=[],sr.StyleUtil.set(this.ScrollTable,"display","none"),this.FixedTable&&sr.StyleUtil.set(this.FixedTable,"display","none"),sr.StyleUtil.set(this.FilterMenu,"display","none"),this.TableLoading.start();for(var t=this.ScrollTable;t.hasChildNodes();)t.removeChild(t.firstChild);if(this.FixedTable)for(t=this.FixedTable;t.hasChildNodes();)t.removeChild(t.firstChild);this.ActiveNo=-1},sr.DataTable.prototype.createTd=function(t,e,i,l){var a=document.createElement("td");if(a.setAttribute("data-col",t.No),e.length>i){var s='<span class="data-table-body-td-content">'+e[i]+"</span>";if(0<t.Tags.length)for(var r=0;r<t.Tags.length;r++)if(t.Tags[r].name==e[i]){s='<span class="data-table-body-td-tag" style="background-color:'+t.Tags[r].color+';">'+s+"</span>";break}"rate-bar"==t.DataType&&(s='<span class="data-table-body-td-rate-bar" style="width:'+Number(100*e[i])+'%;"></span>'),t.Link?a.innerHTML='<a href="'+t.Link(l)+'" target="_blank">'+s+"</a>":t.Action?a.innerHTML="<a>"+s+"</a>":a.innerHTML=s}return a.className="data-table-body-td",a.style.cssText="text-align:"+t.Align,sr.StyleUtil.set(a,"width",t.WrapperWidth+"px"),a},sr.DataTable.prototype.loadData=function(t){if(this.wait(),0==t.length?sr.StyleUtil.set(this.DefaultNoData,"display","block"):sr.StyleUtil.set(this.DefaultNoData,"display","none"),this.FixedTable){var e=document.createElement("tbody");this.FixedTable.appendChild(e)}var i=document.createElement("tbody");this.ScrollTable.appendChild(i);for(var l=0;l<t.length;l++){var a=t[l];if(this.FixedTable){var s=document.createElement("tr");if(s.setAttribute("data-row",l),s.setAttribute("data-id",a.id),this.hasNo)(d=document.createElement("td")).className="data-table-body-td",d.innerHTML=l+1,sr.StyleUtil.set(d,"width",this.TitleNo.WrapperWidth+"px"),s.appendChild(d);for(var r=0;r<this.FixColNo;r++){var d=this.createTd(this.TitleList[r],a.cols,r,a.id);s.appendChild(d)}e.appendChild(s),this.FixedRows.push(s)}(s=document.createElement("tr")).setAttribute("data-row",l),s.setAttribute("data-id",a.id);d=document.createElement("td");sr.StyleUtil.set(d,"width",this.FixedWidth+"px"),s.appendChild(d);for(r=this.FixColNo;r<this.TitleList.length;r++){d=this.createTd(this.TitleList[r],a.cols,r,a.id);s.appendChild(d)}(d=document.createElement("td")).className="data-table-body-td",s.appendChild(d),i.appendChild(s),this.ScrollRows.push(s)}this.adjustWidth(),this.TableLoading.stop(),sr.StyleUtil.del(this.ScrollTable,"display"),this.FixedHead&&sr.StyleUtil.del(this.FixedTable,"display")},sr.DataTable.prototype.setFilterList=function(t){for(var e=0;e<t.length;e++)for(var i=0;i<this.TitleList.length;i++){var l=this.TitleList[i];if(l.Id==t[e].id){l.setFilterList(t[e]);break}}},sr.DataTable.prototype.getSortFields=function(){for(var t=[],e=this.TitleList,i=0;i<e.length;i++)0<e[i].SortMode.length&&t.push({name:e[i].Id,mode:e[i].SortMode});return t},sr.DataTable.prototype.getFilterFields=function(){for(var t=[],e=this.TitleList,i=[],l=[],a="select",s=0;s<e.length;s++)if(1!=e[s].isSelectAll()){if(e[s].AsymcLoadFilter)0<e[s].selectVal.length?i=e[s].selectVal:0<e[s].unselectVal.length&&(i=e[s].unselectVal,a="unselect");else{i=[],l=[],a="select";for(var r=0;r<e[s].FilterList.length;r++)e[s].FilterList[r].selected?i.push(e[s].FilterList[r].name):l.push(e[s].FilterList[r].name);l.length<i.length&&(a="unselect",i=l)}t.push({id:e[s].Id,mode:a,values:i})}return t},sr.DataTable.prototype.resetFilter=function(){for(var t=this.TitleList,e=0;e<t.length;e++){var i=t[e];i.setSort(),i.resetFilterList()}},sr.DataTable.prototype.getFilterList=function(){for(var t=[],e=this.TitleList,i=[],l=0;l<e.length;l++)if(e[l].Filterable&&!e[l].AsymcLoadFilter){i=[];for(var a=0;a<e[l].FilterList.length;a++)i.push(e[l].FilterList[a].name);t.push({id:e[l].Id,values:i})}return t}};



//togl
sr.ToggleBtn=function(t,e,s){this.ParentDOM=document.getElementById(t);var l=document.createElement("div");this.ParentDOM.appendChild(l),l.className="on"==s?"toggle-btn toggle-btn-on":"toggle-btn toggle-btn-off",this.Back=l;var o=document.createElement("div");this.Back.appendChild(o),o.className="toggle-dot",this.Dot=o,this.Activated=!0;var a=this;sr.EventUtil.add(l,"click",function(t){a.Activated&&(sr.ClassUtil.has(l,"toggle-btn-off")?(l.className="toggle-btn toggle-btn-on",e&&e("on")):(l.className="toggle-btn toggle-btn-off",e&&e("off")))}),sr.ToggleBtn.prototype.activate=function(t){var e=this.Back;t?(this.Activated=!0,sr.ClassUtil.has(e,"toggle-btn-disable")&&sr.ClassUtil.del(e,"toggle-btn-disable")):(this.Activated=!1,sr.ClassUtil.has(e,"toggle-btn-disable")||sr.ClassUtil.add(e,"toggle-btn-disable"))},sr.ToggleBtn.prototype.setOn=function(t){a.Activated&&(this.Back.className="toggle-btn toggle-btn-on",e&&e("on"))},sr.ToggleBtn.prototype.setOff=function(t){a.Activated&&(this.Back.className="toggle-btn toggle-btn-off",e&&e("off"))}};


//select
sr.Select=function(e,t){this.Wrapper=e,this.MultiSelect=t.Multi||!1,this.ValList=t.Value,this.SelectVal=[],ul=document.createElement("ul"),ul.className="sr-select-ul",e.appendChild(ul),this.Html=ul;for(var l=0;l<this.ValList.length;l++){var a=document.createElement("li");a.className="sr-select-li",a.setAttribute("data-value",this.ValList[l]),a.innerHTML="<div class='sr-select-item'>"+this.ValList[l]+"</div>",ul.appendChild(a)}sr.Select.prototype.getSelectedVal=function(){return this.SelectVal};var n=this;sr.Select.prototype.setSelectedVal=function(e){n.SelectVal.length=0;for(var t=n.Html.children,l=0;l<t.length;l++)sr.ClassUtil.del(t[l],"choosed");for(l=0;l<e.length;l++)for(var a=0;a<t.length;a++)t[a].getAttribute("data-value")==e[l]&&(sr.ClassUtil.add(t[a],"choosed"),n.SelectVal.push(e[l]))},sr.EventUtil.add(this.Html,"click",function(e){var t=e||window.event,l=t.srcElement||t.target;if("LI"==l.nodeName||"LI"==l.parentNode.nodeName){var a=l;if("LI"==l.parentNode.nodeName&&(a=l.parentNode),sr.ClassUtil.has(a,"sr-select-li"))for(var s=a.getAttribute("data-value"),i=n.Html.children,r=0;r<i.length;r++)if(i[r].getAttribute("data-value")!=s){if(!n.MultiSelect){sr.ClassUtil.del(i[r],"choosed");for(var c=0;c<n.SelectVal.length;c++)if(n.SelectVal[c]==i[r].getAttribute("data-value")){n.SelectVal.splice(c,1);break}}}else{var d=!1;for(c=0;c<n.SelectVal.length;c++)if(n.SelectVal[c]==s){n.SelectVal.splice(c,1),sr.ClassUtil.del(a,"choosed"),d=!0;break}d||(n.SelectVal.push(s),sr.ClassUtil.add(a,"choosed"))}}})};


//bubble box
sr.BubbleBox=function(e,b,t,o){this.Timeout=o||3,this.Parent=e,this.isClear=!1;var s=document.createElement("div");s.className="bubble-box-wrapper",e.appendBox(s),this.Wrapper=s;var i=document.createElement("div");i.className="bubble-box",s.appendChild(i),this.Box=i;var a=document.createElement("span");a.className="bubble-box-icon","ok"==b?a.className="bubble-box-icon bubble-box-icon-ok":"warn"==b?a.className="bubble-box-icon bubble-box-icon-warn":"err"==b&&(a.className="bubble-box-icon bubble-box-icon-err"),i.appendChild(a);var n=document.createElement("span");n.className="bubble-box-text",n.innerHTML=t,i.appendChild(n),setTimeout(function(){i.className="bubble-box bubble-box-show"},200),sr.BubbleBox.prototype.hide=function(){if(!this.isClear){this.isClear=!0;var e=this.Wrapper,b=this.Parent;this.Box;this.Box.className="bubble-box bubble-box-hide",setTimeout(function(){b.removeBox(e),e=null},500)}};o=this.Timeout;var l=this;-1!=o&&setTimeout(function(){l.hide()},1e3*o),sr.EventUtil.add(this.Box,"click",function(){l.hide()})},sr.BubbleMsg=function(e){if(e)this.MsgArea=document.getElementById(e);else{var b=document.createElement("div");b.className="bubble-msg-area",this.MsgArea=b,document.body.appendChild(b)}sr.BubbleMsg.prototype.add=function(e,b,t){new sr.BubbleBox(this,e,b,t)},sr.BubbleMsg.prototype.appendBox=function(e){this.MsgArea.appendChild(e)},sr.BubbleMsg.prototype.removeBox=function(e){this.MsgArea.removeChild(e)}};

