function ImgLazyLoad(l,n){for(var c=[],t=document.querySelectorAll("img"),e=0;e<t.length;e++)c[e]=t[e],t[e].className="PreImg";
function r(){for(var t=0;t<c.length;t++){var e=c[t],r=e.offsetTop-l;if(r<0&&(r=0),!(r<(document.body.scrollTop||document.documentElement.scrollTop)+window.innerHeight))break;
var o=e.getAttribute("data-src");e.getAttribute("src")||(e.setAttribute("src",o),EventUtil.add(e,"error",EventUtil.throttle(function(t){"ErrImg"!=this.className&&(this.className="ErrImg",this.src=n||"")},100,500)))}}EventUtil.add(document,"scroll",EventUtil.throttle(r,100,100)),r()}

function TreeMenuNode(e,t,o){this.NodeId=t.PageId,this.PageHtml=document.getElementById(this.NodeId)||null,this.Level=e,this.Link=t.link||null,this.Parent=o,this.ChildNode=[];var l,n=document.createElement("li");(n.className="tree-menu-li",this.Html=n,this.Parent.Html.appendChild(n),e<=2)?(l=document.createElement("h"+(e+1))).className="tree-menu-h"+(e+1):(l=document.createElement("h4")).className="tree-menu-h4";n.appendChild(l);var i=document.createElement("a");i.className="tree-menu-a",i.innerHTML=t.name,i.setAttribute("data-title",this.NodeId),this.Link&&i.setAttribute("href",this.Link),l.appendChild(i),this.TitleHtml=i;var r,s=this;if(TreeMenuNode.prototype.scrollAnimate=function(e,t){t=t||80,e<0&&(e=0),e>document.body.scrollHeight-window.innerHeight&&(e=document.body.scrollHeight-window.innerHeight);var o=document.body.scrollTop||document.documentElement.scrollTop;t<o-e?(document.body.scrollTop-=t,document.documentElement.scrollTop-=t):t<e-o?(document.body.scrollTop+=t,document.documentElement.scrollTop+=t):(clearInterval(r),document.body.scrollTop=e,document.documentElement.scrollTop=e,s.Parent.setClick(!1))},TreeMenuNode.prototype.Offset=function(){return this.Parent.Offset()},TreeMenuNode.prototype.setClick=function(e){this.Parent.setClick(e)},TreeMenuNode.prototype.active=function(e){this.TitleHtml.className=e?"tree-menu-a highlight":"tree-menu-a"},TreeMenuNode.prototype.scrollPage=function(){var e=this.scrollAnimate,t=this.PageHtml.offsetTop-this.Offset(),o=document.body.scrollTop||document.documentElement.scrollTop,l=Math.abs(o-t)/20;this.Parent.setClick(!0),r=setInterval(function(){e(t,l)},1)},TreeMenuNode.prototype.addScrollNode=function(e){this.Parent.addScrollNode(e)},this.PageHtml&&this.addScrollNode(this),t.list){var d=document.createElement("ul");d.className="tree-menu-ul",this.Html.appendChild(d);for(var c=0;c<t.list.length;c++){var a=new TreeMenuNode(e+1,t.list[c],this);this.ChildNode.push(a),d.appendChild(a.Html)}}}function TreeMenu(e,t,o,l){this.NodeList=[],this.ScrollNode=[],this.HighlightNode=null,this.ScrollOffset=o||0,this.Parent=e,this.Top=l||40,this.isClick=!1,t=t||[],e.className="tree-menu",StyleUtil.set(e,"display","none");var n=document.createElement("ul");n.className="tree-menu-ul",this.Html=n,e.appendChild(n);var r=this;TreeMenu.prototype.addScrollNode=function(e){this.ScrollNode.push(e)},TreeMenu.prototype.Offset=function(){return this.ScrollOffset},TreeMenu.prototype.setClick=function(e){this.isClick=e};for(var i=0;i<t.length;i++){var s=new TreeMenuNode(1,t[i],this);this.NodeList.push(s),n.appendChild(s.Html)}TreeMenu.prototype.anchorPage=function(){if(!r.isClick)for(var e=r.ScrollNode,t=0;t<e.length;t++){var o=e[t],l=0;l=t<e.length-1?e[t+1].PageHtml.offsetTop-r.Offset():document.body.scrollHeight||document.documentElement.scrollHeight;var n=o.PageHtml.offsetTop-r.Offset();(n<0||0==t)&&(n=0);var i=document.body.scrollTop||document.documentElement.scrollTop;if(n<=i&&i<l){r.HighlightNode&&r.HighlightNode.active(!1),o.active(!0),r.HighlightNode=o;break}}},EventUtil.add(document,"scroll",EventUtil.throttle(r.anchorPage,100,100)),EventUtil.add(n,"click",function(e){var t=e||window.event,o=t.srcElement||t.target;if("a"==o.nodeName.toLowerCase())for(var l=o.getAttribute("data-title"),n=r.ScrollNode,i=0;i<n.length;i++)if(n[i].NodeId==l){n[i].scrollPage();break}}),EventUtil.add(window,"resize",function(){StyleUtil.set(r.Parent,"height",window.innerHeight-r.Top+"px")}),StyleUtil.set(e,"height",window.innerHeight-r.Top+"px"),StyleUtil.del(e,"display"),this.anchorPage()}


